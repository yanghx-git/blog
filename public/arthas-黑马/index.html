<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>arthas-黑马 - yanghx blog</title><meta name="Description" content="yanghx blog"><meta property="og:title" content="arthas-黑马" />
<meta property="og:description" content="《Arthas基础学习》 概述 Arthas（阿尔萨斯） 能为你做什么？ Arthas 是Alibaba开源的Java诊断工具，深受开发者喜爱。 当你遇到以下类似" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" /><meta property="og:image" content="http://yanghx.vip/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-20T02:42:30+08:00" />
<meta property="article:modified_time" content="2023-03-20T02:42:30+08:00" /><meta property="og:site_name" content="yanghx blog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://yanghx.vip/logo.png"/>

<meta name="twitter:title" content="arthas-黑马"/>
<meta name="twitter:description" content="《Arthas基础学习》 概述 Arthas（阿尔萨斯） 能为你做什么？ Arthas 是Alibaba开源的Java诊断工具，深受开发者喜爱。 当你遇到以下类似"/>
<meta name="application-name" content="DoIt">
<meta name="apple-mobile-web-app-title" content="DoIt">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" /><link rel="prev" href="http://yanghx.vip/k8s-%E9%BB%91%E9%A9%AC/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "arthas-黑马",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/yanghx.vip\/arthas-%E9%BB%91%E9%A9%AC\/"
        },"genre": "posts","keywords": "arthas","wordcount":  14302 ,
        "url": "http:\/\/yanghx.vip\/arthas-%E9%BB%91%E9%A9%AC\/","datePublished": "2023-03-20T02:42:30+08:00","dateModified": "2023-03-20T02:42:30+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "yanghx"
            },"description": ""
    }
    </script><script src="//instant.page/5.1.1" defer type="module" integrity="sha384-MWfCL6g1OTGsbSwfuMHc8+8J2u71/LA8dzlIN3ycajckxuZZmF+DNjdm7O6H3PSq"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');}
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="yanghx blog">yanghx blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/series/"> 系列 </a><a class="menu-item" href="/posts/mysql/mysql45/"> mysql45讲 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" class="menu-item theme-select" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="切换主题">
                        <option value="light">浅色</option>
                        <option value="dark">深色</option>
                        <option value="black">黑色</option>
                        <option value="auto">跟随系统</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="yanghx blog">yanghx blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/series/" title="">系列</a><a class="menu-item" href="/posts/mysql/mysql45/" title="">mysql45讲</a><a href="#" class="menu-item theme-select" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="切换主题">
                    <option value="light">浅色</option>
                    <option value="dark">深色</option>
                    <option value="black">黑色</option>
                    <option value="auto">跟随系统</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">目录</h2>
        <div class="toc-content always-active" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#arthas阿尔萨斯-能为你做什么">Arthas（阿尔萨斯） 能为你做什么？</a></li>
    <li><a href="#运行环境要求">运行环境要求</a></li>
  </ul>

  <ul>
    <li><a href="#命令">命令</a></li>
    <li><a href="#windows下安装">Windows下安装</a></li>
    <li><a href="#小结">小结</a></li>
  </ul>

  <ul>
    <li><a href="#步骤">步骤</a></li>
    <li><a href="#小结-1">小结</a></li>
    <li><a href="#卸载">卸载</a>
      <ul>
        <li><a href="#在-linuxunixmac-平台">在 Linux/Unix/Mac 平台</a></li>
        <li><a href="#windows平台">Windows平台</a></li>
      </ul>
    </li>
    <li><a href="#小结-2">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标通过案例快速入门">目标：通过案例快速入门</a></li>
    <li><a href="#步骤-1">步骤</a>
      <ul>
        <li><a href="#1-准备代码">1. 准备代码</a></li>
        <li><a href="#2-启动demo">2. 启动Demo</a>
          <ul>
            <li><a href="#命令-1">命令</a></li>
            <li><a href="#效果">效果</a></li>
          </ul>
        </li>
        <li><a href="#3-启动arthas">3. 启动arthas</a></li>
        <li><a href="#4-通过浏览器连接arthas">4. 通过浏览器连接arthas</a></li>
      </ul>
    </li>
    <li><a href="#小结-3">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标">目标</a></li>
    <li><a href="#命令介绍">命令介绍</a>
      <ul>
        <li><a href="#1-dashboard仪表板">1. dashboard仪表板</a></li>
        <li><a href="#2-通过thread命令来获取到arthas-demo进程的main-class">2. 通过thread命令来获取到<code>arthas-demo</code>进程的Main Class</a></li>
        <li><a href="#3-通过jad来反编译main-class">3. 通过jad来反编译Main Class</a></li>
        <li><a href="#4-watch监视">4. watch监视</a></li>
        <li><a href="#5-退出arthas">5. 退出arthas</a></li>
      </ul>
    </li>
    <li><a href="#小结-4">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-1">目标</a></li>
    <li><a href="#help">help</a>
      <ul>
        <li><a href="#作用">作用</a></li>
        <li><a href="#效果-1">效果</a></li>
      </ul>
    </li>
    <li><a href="#cat">cat</a>
      <ul>
        <li><a href="#作用-1">作用</a></li>
        <li><a href="#效果-2">效果</a></li>
      </ul>
    </li>
    <li><a href="#grep">grep</a>
      <ul>
        <li><a href="#作用-2">作用</a></li>
        <li><a href="#语法">语法</a></li>
        <li><a href="#举例">举例</a></li>
      </ul>
    </li>
    <li><a href="#pwd">pwd</a>
      <ul>
        <li><a href="#作用-3">作用</a></li>
        <li><a href="#效果-3">效果</a></li>
      </ul>
    </li>
    <li><a href="#cls">cls</a>
      <ul>
        <li><a href="#作用-4">作用</a></li>
      </ul>
    </li>
    <li><a href="#小结-5">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-2">目标</a></li>
    <li><a href="#session">session</a>
      <ul>
        <li><a href="#作用-5">作用</a></li>
        <li><a href="#效果-4">效果</a></li>
      </ul>
    </li>
    <li><a href="#reset">reset</a>
      <ul>
        <li><a href="#作用-6">作用</a></li>
        <li><a href="#语法-1">语法</a></li>
        <li><a href="#效果-5">效果</a></li>
      </ul>
    </li>
    <li><a href="#version">version</a>
      <ul>
        <li><a href="#作用-7">作用</a></li>
        <li><a href="#效果-6">效果</a></li>
        <li><a href="#history">history</a></li>
        <li><a href="#作用-8">作用</a></li>
        <li><a href="#效果-7">效果</a></li>
      </ul>
    </li>
    <li><a href="#quit">quit</a>
      <ul>
        <li><a href="#作用-9">作用</a></li>
      </ul>
    </li>
    <li><a href="#stop">stop</a>
      <ul>
        <li><a href="#作用-10">作用</a></li>
        <li><a href="#效果-8">效果</a></li>
      </ul>
    </li>
    <li><a href="#keymap">keymap</a>
      <ul>
        <li><a href="#作用-11">作用</a></li>
        <li><a href="#效果-9">效果</a></li>
        <li><a href="#arthas-命令行快捷键">Arthas 命令行快捷键</a></li>
      </ul>
    </li>
    <li><a href="#后台异步命令相关快捷键">后台异步命令相关快捷键</a></li>
    <li><a href="#小结-6">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-3">目标</a></li>
    <li><a href="#dashboard">dashboard</a>
      <ul>
        <li><a href="#作用-12">作用</a></li>
        <li><a href="#效果-10">效果</a></li>
        <li><a href="#数据说明">数据说明</a></li>
      </ul>
    </li>
    <li><a href="#thread线程相关">thread线程相关</a>
      <ul>
        <li><a href="#作用-13">作用</a></li>
        <li><a href="#参数说明">参数说明</a></li>
        <li><a href="#举例-1">举例</a></li>
      </ul>
    </li>
    <li><a href="#jvm">jvm</a>
      <ul>
        <li><a href="#作用-14">作用</a></li>
        <li><a href="#效果-11">效果</a></li>
        <li><a href="#thread相关">THREAD相关</a></li>
        <li><a href="#文件描述符相关">文件描述符相关</a></li>
      </ul>
    </li>
    <li><a href="#sysprop">sysprop</a>
      <ul>
        <li><a href="#作用-15">作用</a></li>
        <li><a href="#举例-2">举例</a></li>
      </ul>
    </li>
    <li><a href="#小结-7">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-4">目标</a></li>
    <li><a href="#sysenv">sysenv</a>
      <ul>
        <li><a href="#作用-16">作用</a></li>
        <li><a href="#举例-3">举例</a></li>
        <li><a href="#效果-12">效果</a></li>
      </ul>
    </li>
    <li><a href="#vmoption">vmoption</a>
      <ul>
        <li><a href="#作用-17">作用</a></li>
        <li><a href="#举例-4">举例</a></li>
      </ul>
    </li>
    <li><a href="#getstatic">getstatic</a>
      <ul>
        <li><a href="#作用-18">作用</a></li>
        <li><a href="#语法-2">语法</a></li>
        <li><a href="#举例-5">举例</a></li>
      </ul>
    </li>
    <li><a href="#ognl">ognl</a>
      <ul>
        <li><a href="#作用-19">作用</a></li>
        <li><a href="#ognl语法">OGNL语法</a></li>
        <li><a href="#参数说明-1">参数说明</a></li>
        <li><a href="#举例-6">举例</a></li>
        <li><a href="#效果-13">效果</a></li>
      </ul>
    </li>
    <li><a href="#小结-8">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-5">目标</a></li>
    <li><a href="#sc">sc</a>
      <ul>
        <li><a href="#作用-20">作用</a></li>
        <li><a href="#参数说明-2">参数说明</a></li>
        <li><a href="#举例-7">举例</a></li>
      </ul>
    </li>
    <li><a href="#sm">sm</a>
      <ul>
        <li><a href="#作用-21">作用</a></li>
        <li><a href="#参数说明-3">参数说明</a></li>
        <li><a href="#举例-8">举例</a></li>
      </ul>
    </li>
    <li><a href="#小结-9">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-6">目标</a></li>
    <li><a href="#jad">jad</a>
      <ul>
        <li><a href="#作用-22">作用</a></li>
        <li><a href="#参数说明-4">参数说明</a></li>
        <li><a href="#举例-9">举例</a></li>
      </ul>
    </li>
    <li><a href="#mc">mc</a>
      <ul>
        <li><a href="#作用-23">作用</a></li>
        <li><a href="#举例-10">举例</a></li>
        <li><a href="#效果-14">效果</a></li>
      </ul>
    </li>
    <li><a href="#redefine">redefine</a>
      <ul>
        <li><a href="#作用-24">作用</a></li>
        <li><a href="#redefine的限制">redefine的限制</a></li>
        <li><a href="#案例结合-jadmc-命令使用">案例：结合 jad/mc 命令使用</a>
          <ul>
            <li><a href="#步骤-2">步骤</a></li>
            <li><a href="#结果">结果</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#小结-10">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-25">作用</a>
      <ul>
        <li><a href="#参数">参数</a></li>
      </ul>
    </li>
    <li><a href="#举例-11">举例</a></li>
    <li><a href="#效果-15">效果</a></li>
    <li><a href="#小结-11">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-7">目标</a></li>
    <li><a href="#作用-26">作用</a></li>
    <li><a href="#参数说明-5">参数说明</a></li>
    <li><a href="#举例-12">举例</a></li>
    <li><a href="#小结-12">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-8">目标</a></li>
    <li><a href="#作用-27">作用</a></li>
    <li><a href="#参数说明-6">参数说明</a></li>
    <li><a href="#举例-13">举例</a></li>
    <li><a href="#监控的维度说明">监控的维度说明</a></li>
    <li><a href="#小结-13">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-9">目标</a></li>
    <li><a href="#作用-28">作用</a></li>
    <li><a href="#参数说明-7">参数说明</a>
      <ul>
        <li><a href="#特别说明">特别说明</a></li>
      </ul>
    </li>
    <li><a href="#举例-14">举例</a></li>
    <li><a href="#小结-14">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-10">目标</a></li>
    <li><a href="#介绍">介绍</a></li>
    <li><a href="#参数说明-8">参数说明</a></li>
    <li><a href="#举例-15">举例</a></li>
    <li><a href="#小结-15">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-29">作用</a></li>
    <li><a href="#介绍-1">介绍</a></li>
    <li><a href="#参数说明-9">参数说明</a></li>
    <li><a href="#举例-16">举例</a></li>
    <li><a href="#小结-16">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-30">作用</a></li>
    <li><a href="#介绍-2">介绍</a></li>
    <li><a href="#参数解析">参数解析</a></li>
    <li><a href="#使用案例">使用案例</a>
      <ul>
        <li><a href="#基本使用">基本使用</a></li>
        <li><a href="#表格字段说明">表格字段说明</a></li>
        <li><a href="#检索调用记录">检索调用记录</a></li>
        <li><a href="#查看调用信息">查看调用信息</a></li>
        <li><a href="#重做一次调用">重做一次调用</a></li>
      </ul>
    </li>
    <li><a href="#小结-17">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-31">作用</a></li>
    <li><a href="#全局选项">全局选项</a></li>
    <li><a href="#案例">案例</a>
      <ul>
        <li><a href="#查看所有的options">查看所有的options</a></li>
        <li><a href="#获取option的值">获取option的值</a></li>
        <li><a href="#设置指定的option">设置指定的option</a></li>
      </ul>
    </li>
    <li><a href="#小结-18">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-11">目标</a></li>
    <li><a href="#介绍-3">介绍</a></li>
    <li><a href="#案例-1">案例</a>
      <ul>
        <li><a href="#启动profiler">启动profiler</a></li>
        <li><a href="#显示支持的事件">显示支持的事件</a></li>
        <li><a href="#获取已采集的sample的数量">获取已采集的sample的数量</a></li>
        <li><a href="#查看profiler状态">查看profiler状态</a></li>
        <li><a href="#停止profiler">停止profiler</a>
          <ul>
            <li><a href="#生成svg格式结果">生成svg格式结果</a></li>
            <li><a href="#生成html格式结果">生成html格式结果</a></li>
          </ul>
        </li>
        <li><a href="#通过浏览器查看arthas-output下面的profiler结果">通过浏览器查看arthas-output下面的profiler结果</a></li>
      </ul>
    </li>
    <li><a href="#火焰图的含义">火焰图的含义</a></li>
    <li><a href="#小结-19">小结</a></li>
  </ul>

  <ul>
    <li><a href="#需求">需求</a>
      <ul>
        <li><a href="#1-哪个controller处理了请求">1. 哪个Controller处理了请求</a></li>
        <li><a href="#2-每个请求的调用参数和返回值是多少">2. 每个请求的调用参数和返回值是多少</a></li>
      </ul>
    </li>
    <li><a href="#准备场景">准备场景</a></li>
    <li><a href="#步骤-3">步骤</a></li>
    <li><a href="#实现步骤">实现步骤</a></li>
    <li><a href="#结论">结论</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle", "normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">arthas-黑马</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><i class="author fas fa-user-circle fa-fw"></i><a href="/" title="Author" rel=" author" class="author">yanghx</a>
                </span>&nbsp;<span class="post-category">收录于 </span>&nbsp;<span class="post-category">类别 <a href="/categories/arthas/"><i class="far fa-folder fa-fw"></i>arthas</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2023-03-20">2023-03-20</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2023-03-20">2023-03-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 14302 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 29 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#arthas阿尔萨斯-能为你做什么">Arthas（阿尔萨斯） 能为你做什么？</a></li>
    <li><a href="#运行环境要求">运行环境要求</a></li>
  </ul>

  <ul>
    <li><a href="#命令">命令</a></li>
    <li><a href="#windows下安装">Windows下安装</a></li>
    <li><a href="#小结">小结</a></li>
  </ul>

  <ul>
    <li><a href="#步骤">步骤</a></li>
    <li><a href="#小结-1">小结</a></li>
    <li><a href="#卸载">卸载</a>
      <ul>
        <li><a href="#在-linuxunixmac-平台">在 Linux/Unix/Mac 平台</a></li>
        <li><a href="#windows平台">Windows平台</a></li>
      </ul>
    </li>
    <li><a href="#小结-2">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标通过案例快速入门">目标：通过案例快速入门</a></li>
    <li><a href="#步骤-1">步骤</a>
      <ul>
        <li><a href="#1-准备代码">1. 准备代码</a></li>
        <li><a href="#2-启动demo">2. 启动Demo</a>
          <ul>
            <li><a href="#命令-1">命令</a></li>
            <li><a href="#效果">效果</a></li>
          </ul>
        </li>
        <li><a href="#3-启动arthas">3. 启动arthas</a></li>
        <li><a href="#4-通过浏览器连接arthas">4. 通过浏览器连接arthas</a></li>
      </ul>
    </li>
    <li><a href="#小结-3">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标">目标</a></li>
    <li><a href="#命令介绍">命令介绍</a>
      <ul>
        <li><a href="#1-dashboard仪表板">1. dashboard仪表板</a></li>
        <li><a href="#2-通过thread命令来获取到arthas-demo进程的main-class">2. 通过thread命令来获取到<code>arthas-demo</code>进程的Main Class</a></li>
        <li><a href="#3-通过jad来反编译main-class">3. 通过jad来反编译Main Class</a></li>
        <li><a href="#4-watch监视">4. watch监视</a></li>
        <li><a href="#5-退出arthas">5. 退出arthas</a></li>
      </ul>
    </li>
    <li><a href="#小结-4">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-1">目标</a></li>
    <li><a href="#help">help</a>
      <ul>
        <li><a href="#作用">作用</a></li>
        <li><a href="#效果-1">效果</a></li>
      </ul>
    </li>
    <li><a href="#cat">cat</a>
      <ul>
        <li><a href="#作用-1">作用</a></li>
        <li><a href="#效果-2">效果</a></li>
      </ul>
    </li>
    <li><a href="#grep">grep</a>
      <ul>
        <li><a href="#作用-2">作用</a></li>
        <li><a href="#语法">语法</a></li>
        <li><a href="#举例">举例</a></li>
      </ul>
    </li>
    <li><a href="#pwd">pwd</a>
      <ul>
        <li><a href="#作用-3">作用</a></li>
        <li><a href="#效果-3">效果</a></li>
      </ul>
    </li>
    <li><a href="#cls">cls</a>
      <ul>
        <li><a href="#作用-4">作用</a></li>
      </ul>
    </li>
    <li><a href="#小结-5">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-2">目标</a></li>
    <li><a href="#session">session</a>
      <ul>
        <li><a href="#作用-5">作用</a></li>
        <li><a href="#效果-4">效果</a></li>
      </ul>
    </li>
    <li><a href="#reset">reset</a>
      <ul>
        <li><a href="#作用-6">作用</a></li>
        <li><a href="#语法-1">语法</a></li>
        <li><a href="#效果-5">效果</a></li>
      </ul>
    </li>
    <li><a href="#version">version</a>
      <ul>
        <li><a href="#作用-7">作用</a></li>
        <li><a href="#效果-6">效果</a></li>
        <li><a href="#history">history</a></li>
        <li><a href="#作用-8">作用</a></li>
        <li><a href="#效果-7">效果</a></li>
      </ul>
    </li>
    <li><a href="#quit">quit</a>
      <ul>
        <li><a href="#作用-9">作用</a></li>
      </ul>
    </li>
    <li><a href="#stop">stop</a>
      <ul>
        <li><a href="#作用-10">作用</a></li>
        <li><a href="#效果-8">效果</a></li>
      </ul>
    </li>
    <li><a href="#keymap">keymap</a>
      <ul>
        <li><a href="#作用-11">作用</a></li>
        <li><a href="#效果-9">效果</a></li>
        <li><a href="#arthas-命令行快捷键">Arthas 命令行快捷键</a></li>
      </ul>
    </li>
    <li><a href="#后台异步命令相关快捷键">后台异步命令相关快捷键</a></li>
    <li><a href="#小结-6">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-3">目标</a></li>
    <li><a href="#dashboard">dashboard</a>
      <ul>
        <li><a href="#作用-12">作用</a></li>
        <li><a href="#效果-10">效果</a></li>
        <li><a href="#数据说明">数据说明</a></li>
      </ul>
    </li>
    <li><a href="#thread线程相关">thread线程相关</a>
      <ul>
        <li><a href="#作用-13">作用</a></li>
        <li><a href="#参数说明">参数说明</a></li>
        <li><a href="#举例-1">举例</a></li>
      </ul>
    </li>
    <li><a href="#jvm">jvm</a>
      <ul>
        <li><a href="#作用-14">作用</a></li>
        <li><a href="#效果-11">效果</a></li>
        <li><a href="#thread相关">THREAD相关</a></li>
        <li><a href="#文件描述符相关">文件描述符相关</a></li>
      </ul>
    </li>
    <li><a href="#sysprop">sysprop</a>
      <ul>
        <li><a href="#作用-15">作用</a></li>
        <li><a href="#举例-2">举例</a></li>
      </ul>
    </li>
    <li><a href="#小结-7">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-4">目标</a></li>
    <li><a href="#sysenv">sysenv</a>
      <ul>
        <li><a href="#作用-16">作用</a></li>
        <li><a href="#举例-3">举例</a></li>
        <li><a href="#效果-12">效果</a></li>
      </ul>
    </li>
    <li><a href="#vmoption">vmoption</a>
      <ul>
        <li><a href="#作用-17">作用</a></li>
        <li><a href="#举例-4">举例</a></li>
      </ul>
    </li>
    <li><a href="#getstatic">getstatic</a>
      <ul>
        <li><a href="#作用-18">作用</a></li>
        <li><a href="#语法-2">语法</a></li>
        <li><a href="#举例-5">举例</a></li>
      </ul>
    </li>
    <li><a href="#ognl">ognl</a>
      <ul>
        <li><a href="#作用-19">作用</a></li>
        <li><a href="#ognl语法">OGNL语法</a></li>
        <li><a href="#参数说明-1">参数说明</a></li>
        <li><a href="#举例-6">举例</a></li>
        <li><a href="#效果-13">效果</a></li>
      </ul>
    </li>
    <li><a href="#小结-8">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-5">目标</a></li>
    <li><a href="#sc">sc</a>
      <ul>
        <li><a href="#作用-20">作用</a></li>
        <li><a href="#参数说明-2">参数说明</a></li>
        <li><a href="#举例-7">举例</a></li>
      </ul>
    </li>
    <li><a href="#sm">sm</a>
      <ul>
        <li><a href="#作用-21">作用</a></li>
        <li><a href="#参数说明-3">参数说明</a></li>
        <li><a href="#举例-8">举例</a></li>
      </ul>
    </li>
    <li><a href="#小结-9">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-6">目标</a></li>
    <li><a href="#jad">jad</a>
      <ul>
        <li><a href="#作用-22">作用</a></li>
        <li><a href="#参数说明-4">参数说明</a></li>
        <li><a href="#举例-9">举例</a></li>
      </ul>
    </li>
    <li><a href="#mc">mc</a>
      <ul>
        <li><a href="#作用-23">作用</a></li>
        <li><a href="#举例-10">举例</a></li>
        <li><a href="#效果-14">效果</a></li>
      </ul>
    </li>
    <li><a href="#redefine">redefine</a>
      <ul>
        <li><a href="#作用-24">作用</a></li>
        <li><a href="#redefine的限制">redefine的限制</a></li>
        <li><a href="#案例结合-jadmc-命令使用">案例：结合 jad/mc 命令使用</a>
          <ul>
            <li><a href="#步骤-2">步骤</a></li>
            <li><a href="#结果">结果</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#小结-10">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-25">作用</a>
      <ul>
        <li><a href="#参数">参数</a></li>
      </ul>
    </li>
    <li><a href="#举例-11">举例</a></li>
    <li><a href="#效果-15">效果</a></li>
    <li><a href="#小结-11">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-7">目标</a></li>
    <li><a href="#作用-26">作用</a></li>
    <li><a href="#参数说明-5">参数说明</a></li>
    <li><a href="#举例-12">举例</a></li>
    <li><a href="#小结-12">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-8">目标</a></li>
    <li><a href="#作用-27">作用</a></li>
    <li><a href="#参数说明-6">参数说明</a></li>
    <li><a href="#举例-13">举例</a></li>
    <li><a href="#监控的维度说明">监控的维度说明</a></li>
    <li><a href="#小结-13">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-9">目标</a></li>
    <li><a href="#作用-28">作用</a></li>
    <li><a href="#参数说明-7">参数说明</a>
      <ul>
        <li><a href="#特别说明">特别说明</a></li>
      </ul>
    </li>
    <li><a href="#举例-14">举例</a></li>
    <li><a href="#小结-14">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-10">目标</a></li>
    <li><a href="#介绍">介绍</a></li>
    <li><a href="#参数说明-8">参数说明</a></li>
    <li><a href="#举例-15">举例</a></li>
    <li><a href="#小结-15">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-29">作用</a></li>
    <li><a href="#介绍-1">介绍</a></li>
    <li><a href="#参数说明-9">参数说明</a></li>
    <li><a href="#举例-16">举例</a></li>
    <li><a href="#小结-16">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-30">作用</a></li>
    <li><a href="#介绍-2">介绍</a></li>
    <li><a href="#参数解析">参数解析</a></li>
    <li><a href="#使用案例">使用案例</a>
      <ul>
        <li><a href="#基本使用">基本使用</a></li>
        <li><a href="#表格字段说明">表格字段说明</a></li>
        <li><a href="#检索调用记录">检索调用记录</a></li>
        <li><a href="#查看调用信息">查看调用信息</a></li>
        <li><a href="#重做一次调用">重做一次调用</a></li>
      </ul>
    </li>
    <li><a href="#小结-17">小结</a></li>
  </ul>

  <ul>
    <li><a href="#作用-31">作用</a></li>
    <li><a href="#全局选项">全局选项</a></li>
    <li><a href="#案例">案例</a>
      <ul>
        <li><a href="#查看所有的options">查看所有的options</a></li>
        <li><a href="#获取option的值">获取option的值</a></li>
        <li><a href="#设置指定的option">设置指定的option</a></li>
      </ul>
    </li>
    <li><a href="#小结-18">小结</a></li>
  </ul>

  <ul>
    <li><a href="#目标-11">目标</a></li>
    <li><a href="#介绍-3">介绍</a></li>
    <li><a href="#案例-1">案例</a>
      <ul>
        <li><a href="#启动profiler">启动profiler</a></li>
        <li><a href="#显示支持的事件">显示支持的事件</a></li>
        <li><a href="#获取已采集的sample的数量">获取已采集的sample的数量</a></li>
        <li><a href="#查看profiler状态">查看profiler状态</a></li>
        <li><a href="#停止profiler">停止profiler</a>
          <ul>
            <li><a href="#生成svg格式结果">生成svg格式结果</a></li>
            <li><a href="#生成html格式结果">生成html格式结果</a></li>
          </ul>
        </li>
        <li><a href="#通过浏览器查看arthas-output下面的profiler结果">通过浏览器查看arthas-output下面的profiler结果</a></li>
      </ul>
    </li>
    <li><a href="#火焰图的含义">火焰图的含义</a></li>
    <li><a href="#小结-19">小结</a></li>
  </ul>

  <ul>
    <li><a href="#需求">需求</a>
      <ul>
        <li><a href="#1-哪个controller处理了请求">1. 哪个Controller处理了请求</a></li>
        <li><a href="#2-每个请求的调用参数和返回值是多少">2. 每个请求的调用参数和返回值是多少</a></li>
      </ul>
    </li>
    <li><a href="#准备场景">准备场景</a></li>
    <li><a href="#步骤-3">步骤</a></li>
    <li><a href="#实现步骤">实现步骤</a></li>
    <li><a href="#结论">结论</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="arthas基础学习" class="headerLink">
    <a href="#arthas%e5%9f%ba%e7%a1%80%e5%ad%a6%e4%b9%a0" class="header-mark"></a>《Arthas基础学习》</h1><h1 id="概述" class="headerLink">
    <a href="#%e6%a6%82%e8%bf%b0" class="header-mark"></a>概述</h1><h2 id="arthas阿尔萨斯-能为你做什么" class="headerLink">
    <a href="#arthas%e9%98%bf%e5%b0%94%e8%90%a8%e6%96%af-%e8%83%bd%e4%b8%ba%e4%bd%a0%e5%81%9a%e4%bb%80%e4%b9%88" class="header-mark"></a>Arthas（阿尔萨斯） 能为你做什么？</h2><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png" title="image-20200305153259359" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153259359.png">
    </a></p>
<p><code>Arthas</code> 是Alibaba开源的Java诊断工具，深受开发者喜爱。</p>
<p>当你遇到以下类似问题而束手无策时，<code>Arthas</code>可以帮助你解决：</p>
<ol>
<li>这个类从哪个 jar 包加载的？为什么会报各种类相关的 Exception？</li>
<li>我改的代码为什么没有执行到？难道是我没 commit？分支搞错了？</li>
<li>遇到问题无法在线上 debug，难道只能通过加日志再重新发布吗？</li>
<li>线上遇到某个用户的数据处理有问题，但线上同样无法 debug，线下无法重现！</li>
<li>是否有一个全局视角来查看系统的运行状况？</li>
<li>有什么办法可以监控到JVM的实时运行状态？</li>
<li>怎么快速定位应用的热点，生成火焰图？</li>
</ol>
<h2 id="运行环境要求" class="headerLink">
    <a href="#%e8%bf%90%e8%a1%8c%e7%8e%af%e5%a2%83%e8%a6%81%e6%b1%82" class="header-mark"></a>运行环境要求</h2><p><code>Arthas</code>支持JDK 6+，支持Linux/Mac/Windows，采用命令行交互模式，同时提供丰富的 <code>Tab</code> 自动补全功能，进一步方便进行问题的定位和诊断。</p>
<h1 id="快速安装" class="headerLink">
    <a href="#%e5%bf%ab%e9%80%9f%e5%ae%89%e8%a3%85" class="header-mark"></a>快速安装</h1><p>下载<code>arthas-boot.jar</code>，然后用<code>java -jar</code>的方式启动：</p>
<h2 id="命令" class="headerLink">
    <a href="#%e5%91%bd%e4%bb%a4" class="header-mark"></a>命令</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -O https://alibaba.github.io/arthas/arthas-boot.jar
</span></span><span class="line"><span class="cl">java -jar arthas-boot.jar
</span></span></code></pre></td></tr></table>
</div>
</div><p>注：在运行第2条命令之前，先运行一个java进程在内存中，不然会出现找不到java进程的错误。</p>
<p>打印帮助信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar -h
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果下载速度比较慢，可以使用aliyun的镜像：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar --repo-mirror aliyun --use-http
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="windows下安装" class="headerLink">
    <a href="#windows%e4%b8%8b%e5%ae%89%e8%a3%85" class="header-mark"></a>Windows下安装</h2><ol>
<li>
<p>在c:\下创建目录arthas，在windows命令窗口下，使用curl命令下载阿里服务器上的jar包，大小108k</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png" title="image-20200305153935492" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305153935492.png">
    </a></p>
</li>
<li>
<p>使用java启动arthas-boot.jar，来安装arthas，大小约10M。运行此命令会发现java进程，输入1按回车。则自动从远程主机上下载arthas到本地目录</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png" title="image-20200305154855501" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305154855501.png">
    </a></p>
</li>
<li>
<p>查看安装好的目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">C:\Users\Administrator\.arthas\lib\3.1.7\arthas\
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155123449.png" alt="image-20200305155123449" style="zoom: 80%;" /> 
</li>
</ol>
<h2 id="小结" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93" class="header-mark"></a>小结</h2><ol>
<li>下载arthas-boot.jar包</li>
<li>执行arthas-boo.jar包，前提是必须要有java进程在运行。第一次执行这个jar包，会自动从服务器上下载arthas，大小是11M</li>
</ol>
<h1 id="从maven仓库下载全量包" class="headerLink">
    <a href="#%e4%bb%8emaven%e4%bb%93%e5%ba%93%e4%b8%8b%e8%bd%bd%e5%85%a8%e9%87%8f%e5%8c%85" class="header-mark"></a>从Maven仓库下载全量包</h1><p>如果下载速度比较慢，可以尝试用<a href="https://maven.aliyun.com/" target="_blank" rel="noopener noreferrer">阿里云的镜像仓库</a></p>
<h2 id="步骤" class="headerLink">
    <a href="#%e6%ad%a5%e9%aa%a4" class="header-mark"></a>步骤</h2><ol>
<li>比如要下载<code>3.1.7</code>版本，下载的url是：</li>
</ol>
<p><a href="https://maven.aliyun.com/repository/public/com/taobao/arthas/arthas-packaging/3.1.7/arthas-packaging-3.1.7-bin.zip" target="_blank" rel="noopener noreferrer">https://maven.aliyun.com/repository/public/com/taobao/arthas/arthas-packaging/3.1.7/arthas-packaging-3.1.7-bin.zip</a></p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png" title="image-20200305160520986" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305160520986.png">
    </a></p>
<ol start="2">
<li>解压后，在文件夹里有<code>arthas-boot.jar</code>，直接用<code>java -jar</code>的方式启动：</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar
</span></span></code></pre></td></tr></table>
</div>
</div><p>注：如果是Linux，可以使用以下命令解压到指定的arthas目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">unzip -d arthas arthas-packaging-3.1.7-bin.zip
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310141654101.png" alt="image-20200310141654101" style="zoom:80%;" /> 
<h2 id="小结-1" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-1" class="header-mark"></a>小结</h2><ol>
<li>在Linux下在线安装的方式与在Windows下的安装相同</li>
<li>如果要使用离线的安装方式，先下载完成的zip到本地，再解压到任意的目录即可</li>
</ol>
<h2 id="卸载" class="headerLink">
    <a href="#%e5%8d%b8%e8%bd%bd" class="header-mark"></a>卸载</h2><h3 id="在-linuxunixmac-平台" class="headerLink">
    <a href="#%e5%9c%a8-linuxunixmac-%e5%b9%b3%e5%8f%b0" class="header-mark"></a>在 Linux/Unix/Mac 平台</h3><p>删除下面文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">rm -rf ~/.arthas/
</span></span><span class="line"><span class="cl">rm -rf ~/logs/arthas
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="windows平台" class="headerLink">
    <a href="#windows%e5%b9%b3%e5%8f%b0" class="header-mark"></a>Windows平台</h3><p>直接删除user home下面的<code>.arthas</code>和<code>logs/arthas</code>目录</p>
<ol>
<li>
<p>安装主目录</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png" title="image-20200305155611311" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155611311.png">
    </a></p>
</li>
<li>
<p>日志记录目录</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png" title="image-20200305155504945" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305155504945.png">
    </a></p>
</li>
</ol>
<h2 id="小结-2" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-2" class="header-mark"></a>小结</h2><p>因为jar包是绿色，要卸载的话，直接删除2个目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.arthas安装目录
</span></span><span class="line"><span class="cl">logs的日志记录目录
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="快速入门attach一个进程" class="headerLink">
    <a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8attach%e4%b8%80%e4%b8%aa%e8%bf%9b%e7%a8%8b" class="header-mark"></a>快速入门：attach一个进程</h1><h2 id="目标通过案例快速入门" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87%e9%80%9a%e8%bf%87%e6%a1%88%e4%be%8b%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8" class="header-mark"></a>目标：通过案例快速入门</h2><ol>
<li>执行一个jar包</li>
<li>通过arthas来attach粘附</li>
</ol>
<h2 id="步骤-1" class="headerLink">
    <a href="#%e6%ad%a5%e9%aa%a4-1" class="header-mark"></a>步骤</h2><h3 id="1-准备代码" class="headerLink">
    <a href="#1-%e5%87%86%e5%a4%87%e4%bb%a3%e7%a0%81" class="header-mark"></a>1. 准备代码</h3><p>以下是一个简单的Java程序，每隔一秒生成一个随机数，再执行质因数分解，并打印出分解结果。代码的内容不用理会这不是现在关注的点。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MathGame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">    <span class="c1">//用于统计生成的不合法变量的个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="kt">int</span> <span class="n">illegalArgumentCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">MathGame</span> <span class="n">game</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MathGame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//死循环，每过1秒调用1次下面的方法(不是开启一个线程)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">game</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//分解质因数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//随机生成一个整数，有可能正，有可能负
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">()/</span><span class="mi">10000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//调用方法进行质因数分解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">primeFactors</span> <span class="o">=</span> <span class="n">primeFactors</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//打印结果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">print</span><span class="o">(</span><span class="n">number</span><span class="o">,</span> <span class="n">primeFactors</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&#34;illegalArgumentCount:%3d, &#34;</span><span class="o">,</span> <span class="n">illegalArgumentCount</span><span class="o">)</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">//打印质因数分解的结果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">primeFactors</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">StringBuffer</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(</span><span class="n">number</span> <span class="o">+</span> <span class="s">&#34;=&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">factor</span> <span class="o">:</span> <span class="n">primeFactors</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">factor</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="sc">&#39;*&#39;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">sb</span><span class="o">.</span><span class="na">deleteCharAt</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sb</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//计算number的质因数分解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">primeFactors</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//如果小于2，则抛出异常，并且计数加1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">number</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">illegalArgumentCount</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;number is: &#34;</span> <span class="o">+</span> <span class="n">number</span> <span class="o">+</span> <span class="s">&#34;, need &gt;= 2&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">			 <span class="c1">//用于保存每个质数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//分解过程，从2开始看能不能整除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">//如果i大于number就退出循环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//能整除，则i为一个因数，number为整除的结果再继续从2开始除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">number</span> <span class="o">=</span> <span class="n">number</span> <span class="o">/</span> <span class="n">i</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">i</span><span class="o">++;</span>  <span class="c1">//否则i++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-启动demo" class="headerLink">
    <a href="#2-%e5%90%af%e5%8a%a8demo" class="header-mark"></a>2. 启动Demo</h3><h4 id="命令-1" class="headerLink">
    <a href="#%e5%91%bd%e4%bb%a4-1" class="header-mark"></a>命令</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">下载已经打包好的arthas-demo.jar
</span></span><span class="line"><span class="cl">curl -O https://alibaba.github.io/arthas/arthas-demo.jar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">在命令行下执行
</span></span><span class="line"><span class="cl">java -jar arthas-demo.jar
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="效果" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c" class="header-mark"></a>效果</h4><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305161852822.png" alt="image-20200305161852822" style="zoom:80%;" />  
<h3 id="3-启动arthas" class="headerLink">
    <a href="#3-%e5%90%af%e5%8a%a8arthas" class="header-mark"></a>3. 启动arthas</h3><ol>
<li>因为arthas-demo.jar进程打开了一个窗口，所以另开一个命令窗口执行arthas-boot.jar</li>
<li>选择要粘附的进程：arthas-demo.jar</li>
</ol>
<img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305162944714.png" alt="image-20200305162944714" style="zoom:80%;" /> 
<ol start="3">
<li>如果粘附成功，在arthas-demo.jar那个窗口中会出现日志记录的信息，记录在c:\Users\Administrator\logs目录下</li>
</ol>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png" title="image-20200305163414111" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305163414111.png">
    </a></p>
<ol start="4">
<li>如果端口号被占用，也可以通过以下命令换成另一个端口号执行</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar --telnet-port 9998 --http-port -1
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-通过浏览器连接arthas" class="headerLink">
    <a href="#4-%e9%80%9a%e8%bf%87%e6%b5%8f%e8%a7%88%e5%99%a8%e8%bf%9e%e6%8e%a5arthas" class="header-mark"></a>4. 通过浏览器连接arthas</h3><p>Arthas目前支持Web Console，用户在attach成功之后，可以直接访问：http://127.0.0.1:3658/。</p>
<p>可以填入IP，远程连接其它机器上的arthas。</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png" title="image-20200310091357372" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310091357372.png">
    </a></p>
<p>默认情况下，arthas只listen 127.0.0.1，所以如果想从远程连接，则可以使用 <code>--target-ip</code>参数指定listen的IP</p>
<h2 id="小结-3" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-3" class="header-mark"></a>小结</h2><ol>
<li>启动被诊断进程</li>
<li>启动arthas-boot.jar，粘贴上面的进程</li>
<li>不但可以通过命令行的方式来操作arthas也可以通过浏览器来访问arthas</li>
</ol>
<h1 id="快速入门常用命令接触" class="headerLink">
    <a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4%e6%8e%a5%e8%a7%a6" class="header-mark"></a>快速入门：常用命令接触</h1><h2 id="目标" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87" class="header-mark"></a>目标</h2><ol>
<li>dashboard仪表板</li>
<li>通过thread命令来获取到<code>arthas-demo</code>进程的Main Class</li>
<li>通过jad来反编译Main Class</li>
<li>watch</li>
</ol>
<h2 id="命令介绍" class="headerLink">
    <a href="#%e5%91%bd%e4%bb%a4%e4%bb%8b%e7%bb%8d" class="header-mark"></a>命令介绍</h2><h3 id="1-dashboard仪表板" class="headerLink">
    <a href="#1-dashboard%e4%bb%aa%e8%a1%a8%e6%9d%bf" class="header-mark"></a>1. dashboard仪表板</h3><p>输入dashboard(仪表板)，按<code>回车/enter</code>，会展示当前进程的信息，按<code>ctrl+c</code>可以中断执行。</p>
<p>注：输入前面部分字母，按tab可以自动补全命令</p>
<ol>
<li>第一部分是显示JVM中运行的所有线程：所在线程组，优先级，线程的状态，CPU的占用率，是否是后台进程等</li>
<li>第二部分显示的JVM内存的使用情况</li>
<li>第三部分是操作系统的一些信息和Java版本号</li>
</ol>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png" title="image-20200305164047346" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305164047346.png">
    </a></p>
<h3 id="2-通过thread命令来获取到arthas-demo进程的main-class" class="headerLink">
    <a href="#2-%e9%80%9a%e8%bf%87thread%e5%91%bd%e4%bb%a4%e6%9d%a5%e8%8e%b7%e5%8f%96%e5%88%b0arthas-demo%e8%bf%9b%e7%a8%8b%e7%9a%84main-class" class="header-mark"></a>2. 通过thread命令来获取到<code>arthas-demo</code>进程的Main Class</h3><p>获取到arthas-demo进程的Main Class</p>
<p><code>thread 1</code>会打印线程ID 1的栈，通常是main函数的线程。</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png" title="image-20200305192646737" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305192646737.png">
    </a></p>
<h3 id="3-通过jad来反编译main-class" class="headerLink">
    <a href="#3-%e9%80%9a%e8%bf%87jad%e6%9d%a5%e5%8f%8d%e7%bc%96%e8%af%91main-class" class="header-mark"></a>3. 通过jad来反编译Main Class</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jad demo.MathGame
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194029146.png" alt="image-20200305194029146" style="zoom:80%;" /> 
<h3 id="4-watch监视" class="headerLink">
    <a href="#4-watch%e7%9b%91%e8%a7%86" class="header-mark"></a>4. watch监视</h3><p>通过watch命令来查看<code>demo.MathGame#primeFactors</code>函数的返回值：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ watch demo.MathGame primeFactors returnObj
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png" title="image-20200305194740589" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200305194740589.png">
    </a></p>
<h3 id="5-退出arthas" class="headerLink">
    <a href="#5-%e9%80%80%e5%87%baarthas" class="header-mark"></a>5. 退出arthas</h3><p>如果只是退出当前的连接，可以用<code>quit</code>或者<code>exit</code>命令。Attach到目标进程上的arthas还会继续运行，端口会保持开放，下次连接时可以直接连接上。</p>
<p>如果想完全退出arthas，可以执行<code>stop</code>命令。</p>
<h2 id="小结-4" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-4" class="header-mark"></a>小结</h2><ol>
<li>
<p>如何启动arthas?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">java -jar arthas-boot.jar
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>说说以下命令的作用</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>dashboard</td>
<td>显示JVM中内存的情况，JVM中环境信息</td>
</tr>
<tr>
<td>thread</td>
<td>显示当前进程所有线程信息</td>
</tr>
<tr>
<td>jad</td>
<td>反编译指定的类或方法</td>
</tr>
<tr>
<td>watch</td>
<td>监视某个方法的执行情况，监视了返回值</td>
</tr>
<tr>
<td>quit，exit,  stop</td>
<td>退出或停止arthas</td>
</tr>
</tbody>
</table>
<h1 id="基础命令之一" class="headerLink">
    <a href="#%e5%9f%ba%e7%a1%80%e5%91%bd%e4%bb%a4%e4%b9%8b%e4%b8%80" class="header-mark"></a>基础命令之一</h1><h2 id="目标-1" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-1" class="header-mark"></a>目标</h2><ol>
<li>help</li>
<li>cat</li>
<li>grep</li>
<li>pwd</li>
<li>cls</li>
</ol>
<h2 id="help" class="headerLink">
    <a href="#help" class="header-mark"></a>help</h2><h3 id="作用" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8" class="header-mark"></a>作用</h3><p>查看命令帮助信息</p>
<h3 id="效果-1" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-1" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png" title="image-20200310092304402" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310092304402.png">
    </a></p>
<h2 id="cat" class="headerLink">
    <a href="#cat" class="header-mark"></a>cat</h2><h3 id="作用-1" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-1" class="header-mark"></a>作用</h3><p>打印文件内容，和linux里的cat命令类似</p>
<p>如果没有写路径，则显示当前目录下的文件</p>
<h3 id="效果-2" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-2" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png" title="image-20200310094255080" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310094255080.png">
    </a></p>
<h2 id="grep" class="headerLink">
    <a href="#grep" class="header-mark"></a>grep</h2><h3 id="作用-2" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-2" class="header-mark"></a>作用</h3><p>匹配查找，和linux里的grep命令类似，但它只能用于管道命令</p>
<h3 id="语法" class="headerLink">
    <a href="#%e8%af%ad%e6%b3%95" class="header-mark"></a>语法</h3><table>
<thead>
<tr>
<th>参数列表</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-n</td>
<td>显示行号</td>
</tr>
<tr>
<td>-i</td>
<td>忽略大小写查找</td>
</tr>
<tr>
<td>-m 行数</td>
<td>最大显示行数，要与查询字符串一起使用</td>
</tr>
<tr>
<td>-e &ldquo;正则表达式&rdquo;</td>
<td>使用正则表达式查找</td>
</tr>
</tbody>
</table>
<h3 id="举例" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">只显示包含java字符串的行系统属性
</span></span><span class="line"><span class="cl">sysprop | grep java
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310100425059.png" alt="image-20200310100425059" style="zoom:80%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">显示包含java字符串的行和行号的系统属性
</span></span><span class="line"><span class="cl">sysprop | grep java -n
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310100505632.png" alt="image-20200310100505632" style="zoom:80%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">显示包含system字符串的10行信息
</span></span><span class="line"><span class="cl">thread | grep system -m 10
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png" title="image-20200310101905466" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310101905466.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">使用正则表达式，显示包含2个o字符的线程信息
</span></span><span class="line"><span class="cl">thread | grep -e &#34;o+&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png" title="image-20200310120512042" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310120512042.png">
    </a></p>
<h2 id="pwd" class="headerLink">
    <a href="#pwd" class="header-mark"></a>pwd</h2><h3 id="作用-3" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-3" class="header-mark"></a>作用</h3><p>返回当前的工作目录，和linux命令类似</p>
<p>pwd: Print Work Directory 打印当前工作目录</p>
<h3 id="效果-3" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-3" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png" title="image-20200310121645656" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121645656.png">
    </a></p>
<h2 id="cls" class="headerLink">
    <a href="#cls" class="header-mark"></a>cls</h2><h3 id="作用-4" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-4" class="header-mark"></a>作用</h3><p>清空当前屏幕区域</p>
<h2 id="小结-5" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-5" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>基础命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="基础命令之二" class="headerLink">
    <a href="#%e5%9f%ba%e7%a1%80%e5%91%bd%e4%bb%a4%e4%b9%8b%e4%ba%8c" class="header-mark"></a>基础命令之二</h1><h2 id="目标-2" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-2" class="header-mark"></a>目标</h2><ol>
<li>session</li>
<li>reset</li>
<li>version</li>
<li>quit</li>
<li>stop</li>
<li>keymap</li>
</ol>
<h2 id="session" class="headerLink">
    <a href="#session" class="header-mark"></a>session</h2><h3 id="作用-5" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-5" class="header-mark"></a>作用</h3><p>查看当前会话的信息</p>
<h3 id="效果-4" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-4" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png" title="image-20200310121756253" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310121756253.png">
    </a></p>
<h2 id="reset" class="headerLink">
    <a href="#reset" class="header-mark"></a>reset</h2><h3 id="作用-6" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-6" class="header-mark"></a>作用</h3><p>重置增强类，将被 Arthas 增强过的类全部还原，Arthas 服务端关闭时会重置所有增强过的类</p>
<h3 id="语法-1" class="headerLink">
    <a href="#%e8%af%ad%e6%b3%95-1" class="header-mark"></a>语法</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">还原指定类
</span></span><span class="line"><span class="cl">reset Test
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">还原所有以List结尾的类
</span></span><span class="line"><span class="cl">reset *List
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">还原所有的类
</span></span><span class="line"><span class="cl">reset
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="效果-5" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-5" class="header-mark"></a>效果</h3><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310133822171.png" alt="image-20200310133822171" style="zoom:80%;" /> 
<h2 id="version" class="headerLink">
    <a href="#version" class="header-mark"></a>version</h2><h3 id="作用-7" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-7" class="header-mark"></a>作用</h3><p>输出当前目标 Java 进程所加载的 Arthas 版本号</p>
<h3 id="效果-6" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-6" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png" title="image-20200310135728790" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135728790.png">
    </a></p>
<h3 id="history" class="headerLink">
    <a href="#history" class="header-mark"></a>history</h3><h3 id="作用-8" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-8" class="header-mark"></a>作用</h3><p>打印命令历史</p>
<h3 id="效果-7" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-7" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png" title="image-20200310135806184" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310135806184.png">
    </a></p>
<h2 id="quit" class="headerLink">
    <a href="#quit" class="header-mark"></a>quit</h2><h3 id="作用-9" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-9" class="header-mark"></a>作用</h3><p>退出当前 Arthas 客户端，其他 Arthas 客户端不受影响</p>
<h2 id="stop" class="headerLink">
    <a href="#stop" class="header-mark"></a>stop</h2><h3 id="作用-10" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-10" class="header-mark"></a>作用</h3><p>关闭 Arthas 服务端，所有 Arthas 客户端全部退出</p>
<h3 id="效果-8" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-8" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png" title="image-20200310140114118" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140114118.png">
    </a></p>
<h2 id="keymap" class="headerLink">
    <a href="#keymap" class="header-mark"></a>keymap</h2><h3 id="作用-11" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-11" class="header-mark"></a>作用</h3><p>Arthas快捷键列表及自定义快捷键</p>
<h3 id="效果-9" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-9" class="header-mark"></a>效果</h3><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310140330818.png" alt="image-20200310140330818" style="zoom:80%;" /> 
<h3 id="arthas-命令行快捷键" class="headerLink">
    <a href="#arthas-%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%bf%ab%e6%8d%b7%e9%94%ae" class="header-mark"></a>Arthas 命令行快捷键</h3><table>
<thead>
<tr>
<th>快捷键说明</th>
<th>命令说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ctrl + a</td>
<td>跳到行首</td>
</tr>
<tr>
<td>ctrl + e</td>
<td>跳到行尾</td>
</tr>
<tr>
<td>ctrl + f</td>
<td>向前移动一个单词</td>
</tr>
<tr>
<td>ctrl + b</td>
<td>向后移动一个单词</td>
</tr>
<tr>
<td>键盘左方向键</td>
<td>光标向前移动一个字符</td>
</tr>
<tr>
<td>键盘右方向键</td>
<td>光标向后移动一个字符</td>
</tr>
<tr>
<td>键盘下方向键</td>
<td>下翻显示下一个命令</td>
</tr>
<tr>
<td>键盘上方向键</td>
<td>上翻显示上一个命令</td>
</tr>
<tr>
<td>ctrl + h</td>
<td>向后删除一个字符</td>
</tr>
<tr>
<td>ctrl + shift + /</td>
<td>向后删除一个字符</td>
</tr>
<tr>
<td>ctrl + u</td>
<td>撤销上一个命令，相当于清空当前行</td>
</tr>
<tr>
<td>ctrl + d</td>
<td>删除当前光标所在字符</td>
</tr>
<tr>
<td>ctrl + k</td>
<td>删除当前光标到行尾的所有字符</td>
</tr>
<tr>
<td>ctrl + i</td>
<td>自动补全，相当于敲<code>TAB</code></td>
</tr>
<tr>
<td>ctrl + j</td>
<td>结束当前行，相当于敲回车</td>
</tr>
<tr>
<td>ctrl + m</td>
<td>结束当前行，相当于敲回车</td>
</tr>
</tbody>
</table>
<ul>
<li>任何时候 <code>tab</code> 键，会根据当前的输入给出提示</li>
<li>命令后敲 <code>-</code> 或 <code>--</code> ，然后按 <code>tab</code> 键，可以展示出此命令具体的选项</li>
</ul>
<h2 id="后台异步命令相关快捷键" class="headerLink">
    <a href="#%e5%90%8e%e5%8f%b0%e5%bc%82%e6%ad%a5%e5%91%bd%e4%bb%a4%e7%9b%b8%e5%85%b3%e5%bf%ab%e6%8d%b7%e9%94%ae" class="header-mark"></a>后台异步命令相关快捷键</h2><ul>
<li>ctrl + c: 终止当前命令</li>
<li>ctrl + z: 挂起当前命令，后续可以 bg/fg 重新支持此命令，或 kill 掉</li>
<li>ctrl + a: 回到行首</li>
<li>ctrl + e: 回到行尾</li>
</ul>
<h2 id="小结-6" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-6" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>session</td>
<td>显示当前会话的信息：进程的ID，会话ID</td>
</tr>
<tr>
<td>reset</td>
<td>重置类的增强，服务器关闭的时候会自动重置所有的类</td>
</tr>
<tr>
<td>version</td>
<td>显示arthas版本号</td>
</tr>
<tr>
<td>quit</td>
<td>退出当前会话，不会影响其它的会话</td>
</tr>
<tr>
<td>stop</td>
<td>退出arthas服务器，所有的会话都停止</td>
</tr>
<tr>
<td>keymap</td>
<td>获取快捷键</td>
</tr>
</tbody>
</table>
<h1 id="jvm相关命令之一" class="headerLink">
    <a href="#jvm%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4%e4%b9%8b%e4%b8%80" class="header-mark"></a>jvm相关命令之一</h1><h2 id="目标-3" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-3" class="header-mark"></a>目标</h2><ol>
<li>dashboard 仪表板</li>
<li>thread 线程相关</li>
<li>jvm 虚拟机相关</li>
<li>sysprop 系统属性相关</li>
</ol>
<h2 id="dashboard" class="headerLink">
    <a href="#dashboard" class="header-mark"></a>dashboard</h2><h3 id="作用-12" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-12" class="header-mark"></a>作用</h3><p>显示当前系统的实时数据面板，按q或ctrl+c退出</p>
<h3 id="效果-10" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-10" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png" title="image-20200310154559668" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310154559668.png">
    </a></p>
<h3 id="数据说明" class="headerLink">
    <a href="#%e6%95%b0%e6%8d%ae%e8%af%b4%e6%98%8e" class="header-mark"></a>数据说明</h3><ul>
<li>ID: Java级别的线程ID，注意这个ID不能跟jstack中的nativeID一一对应</li>
<li>NAME: 线程名</li>
<li>GROUP: 线程组名</li>
<li>PRIORITY: 线程优先级, 1~10之间的数字，越大表示优先级越高</li>
<li>STATE: 线程的状态</li>
<li>CPU%: 线程消耗的cpu占比，采样100ms，将所有线程在这100ms内的cpu使用量求和，再算出每个线程的cpu使用占比。</li>
<li>TIME: 线程运行总时间，数据格式为<code>分：秒</code></li>
<li>INTERRUPTED: 线程当前的中断位状态</li>
<li>DAEMON: 是否是daemon线程</li>
</ul>
<h2 id="thread线程相关" class="headerLink">
    <a href="#thread%e7%ba%bf%e7%a8%8b%e7%9b%b8%e5%85%b3" class="header-mark"></a>thread线程相关</h2><h3 id="作用-13" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-13" class="header-mark"></a>作用</h3><p>查看当前 JVM 的线程堆栈信息</p>
<h3 id="参数说明" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e" class="header-mark"></a>参数说明</h3><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>数字</td>
<td>线程id</td>
</tr>
<tr>
<td>[n:]</td>
<td>指定最忙的前N个线程并打印堆栈</td>
</tr>
<tr>
<td>[b]</td>
<td>找出当前阻塞其他线程的线程</td>
</tr>
<tr>
<td>[i &lt;value&gt;]</td>
<td>指定cpu占比统计的采样间隔，单位为毫秒</td>
</tr>
</tbody>
</table>
<h3 id="举例-1" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-1" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">展示当前最忙的前3个线程并打印堆栈
</span></span><span class="line"><span class="cl">thread -n 3
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png" title="image-20200310155221455" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155221455.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">当没有参数时，显示所有线程的信息
</span></span><span class="line"><span class="cl">thread
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">显示1号线程的运行堆栈
</span></span><span class="line"><span class="cl">thread 1
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png" title="image-20200310155351705" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155351705.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">找出当前阻塞其他线程的线程，有时候我们发现应用卡住了， 通常是由于某个线程拿住了某个锁， 并且其他线程都在等待这把锁造成的。 为了排查这类问题， arthas提供了thread -b， 一键找出那个罪魁祸首。
</span></span><span class="line"><span class="cl">thread -b
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png" title="image-20200310155534864" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155534864.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">指定采样时间间隔，每过1000毫秒采样，显示最占时间的3个线程
</span></span><span class="line"><span class="cl">thread -i 1000 -n 3
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png" title="image-20200310155902397" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310155902397.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">查看处于等待状态的线程
</span></span><span class="line"><span class="cl">thread --state WAITING
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png" title="image-20200310160036202" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160036202.png">
    </a></p>
<h2 id="jvm" class="headerLink">
    <a href="#jvm" class="header-mark"></a>jvm</h2><h3 id="作用-14" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-14" class="header-mark"></a>作用</h3><p>查看当前 JVM 的信息</p>
<h3 id="效果-11" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-11" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png" title="image-20200310160418837" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310160418837.png">
    </a></p>
<h3 id="thread相关" class="headerLink">
    <a href="#thread%e7%9b%b8%e5%85%b3" class="header-mark"></a>THREAD相关</h3><ul>
<li>COUNT: JVM当前活跃的线程数</li>
<li>DAEMON-COUNT: JVM当前活跃的守护线程数</li>
<li>PEAK-COUNT: 从JVM启动开始曾经活着的最大线程数</li>
<li>STARTED-COUNT: 从JVM启动开始总共启动过的线程次数</li>
<li>DEADLOCK-COUNT: JVM当前死锁的线程数</li>
</ul>
<h3 id="文件描述符相关" class="headerLink">
    <a href="#%e6%96%87%e4%bb%b6%e6%8f%8f%e8%bf%b0%e7%ac%a6%e7%9b%b8%e5%85%b3" class="header-mark"></a>文件描述符相关</h3><ul>
<li>MAX-FILE-DESCRIPTOR-COUNT：JVM进程最大可以打开的文件描述符数</li>
<li>OPEN-FILE-DESCRIPTOR-COUNT：JVM当前打开的文件描述符数</li>
</ul>
<h2 id="sysprop" class="headerLink">
    <a href="#sysprop" class="header-mark"></a>sysprop</h2><h3 id="作用-15" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-15" class="header-mark"></a>作用</h3><p>查看和修改JVM的系统属性</p>
<h3 id="举例-2" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-2" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">查看所有属性
</span></span><span class="line"><span class="cl">sysprop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">查看单个属性，支持通过tab补全
</span></span><span class="line"><span class="cl">sysprop java.version
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png" title="image-20200310161328775" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161328775.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">修改单个属性
</span></span><span class="line"><span class="cl">sysprop user.country
</span></span><span class="line"><span class="cl">user.country=US
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sysprop user.country CN
</span></span><span class="line"><span class="cl">Successfully changed the system property.
</span></span><span class="line"><span class="cl">user.country=CN
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png" title="image-20200310161425897" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161425897.png">
    </a></p>
<h2 id="小结-7" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-7" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>jvm相关命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>dashboard</td>
<td>显示线程，内存，GC，系统环境等信息</td>
</tr>
<tr>
<td>thread</td>
<td>显示线程信息</td>
</tr>
<tr>
<td>jvm</td>
<td>与JVM相关的信息</td>
</tr>
<tr>
<td>sysprop</td>
<td>显示系统属性信息，也可以修改某个属性</td>
</tr>
</tbody>
</table>
<h1 id="jvm相关命令之二" class="headerLink">
    <a href="#jvm%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4%e4%b9%8b%e4%ba%8c" class="header-mark"></a>jvm相关命令之二</h1><h2 id="目标-4" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-4" class="header-mark"></a>目标</h2><ol>
<li>sysenv</li>
<li>vmoption</li>
<li>getstatic</li>
<li>ognl</li>
</ol>
<h2 id="sysenv" class="headerLink">
    <a href="#sysenv" class="header-mark"></a>sysenv</h2><h3 id="作用-16" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-16" class="header-mark"></a>作用</h3><p>查看当前JVM的环境属性(<code>System Environment Variables</code>)</p>
<h3 id="举例-3" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-3" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">查看所有环境变量
</span></span><span class="line"><span class="cl">sysenv
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">查看单个环境变量
</span></span><span class="line"><span class="cl">sysenv USER
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="效果-12" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-12" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png" title="image-20200310161659199" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310161659199.png">
    </a></p>
<h2 id="vmoption" class="headerLink">
    <a href="#vmoption" class="header-mark"></a>vmoption</h2><h3 id="作用-17" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-17" class="header-mark"></a>作用</h3><p>查看，更新VM诊断相关的参数</p>
<h3 id="举例-4" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-4" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">查看所有的选项
</span></span><span class="line"><span class="cl">vmoption
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">查看指定的选项
</span></span><span class="line"><span class="cl">vmoption PrintGCDetails
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png" title="image-20200310162027027" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162027027.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">更新指定的选项
</span></span><span class="line"><span class="cl">vmoption PrintGCDetails true
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310162052792.png" alt="image-20200310162052792" style="zoom:80%;" /> 
<h2 id="getstatic" class="headerLink">
    <a href="#getstatic" class="header-mark"></a>getstatic</h2><h3 id="作用-18" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-18" class="header-mark"></a>作用</h3><p>通过getstatic命令可以方便的查看类的静态属性</p>
<h3 id="语法-2" class="headerLink">
    <a href="#%e8%af%ad%e6%b3%95-2" class="header-mark"></a>语法</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">getstatic 类名 属性名
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="举例-5" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-5" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">显示demo.MathGame类中静态属性random
</span></span><span class="line"><span class="cl">getstatic demo.MathGame random
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310163124333.png" alt="image-20200310163124333" style="zoom:80%;" />  
<h2 id="ognl" class="headerLink">
    <a href="#ognl" class="header-mark"></a>ognl</h2><h3 id="作用-19" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-19" class="header-mark"></a>作用</h3><p>执行ognl表达式，这是从3.0.5版本新增的功能</p>
<h3 id="ognl语法" class="headerLink">
    <a href="#ognl%e8%af%ad%e6%b3%95" class="header-mark"></a>OGNL语法</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://commons.apache.org/proper/commons-ognl/language-guide.html
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png" title="image-20200319143015562" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200319143015562.png">
    </a></p>
<h3 id="参数说明-1" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-1" class="header-mark"></a>参数说明</h3><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>express</em></td>
<td>执行的表达式</td>
</tr>
<tr>
<td><code>[c:]</code></td>
<td>执行表达式的 ClassLoader 的 hashcode，默认值是SystemClassLoader</td>
</tr>
<tr>
<td>[x]</td>
<td>结果对象的展开层次，默认值1</td>
</tr>
</tbody>
</table>
<h3 id="举例-6" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-6" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">调用静态函数
</span></span><span class="line"><span class="cl">ognl &#39;@java.lang.System@out.println(&#34;hello&#34;)&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">获取静态类的静态字段
</span></span><span class="line"><span class="cl">ognl &#39;@demo.MathGame@random&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">执行多行表达式，赋值给临时变量，返回一个List
</span></span><span class="line"><span class="cl">ognl &#39;#value1=@System@getProperty(&#34;java.home&#34;), #value2=@System@getProperty(&#34;java.runtime.name&#34;), {#value1, #value2}&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="效果-13" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-13" class="header-mark"></a>效果</h3><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png" title="image-20200310165348164" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310165348164.png">
    </a></p>
<h2 id="小结-8" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-8" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>jvm相关命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sysenv</td>
<td>查看JVM环境变量的值</td>
</tr>
<tr>
<td>vmoption</td>
<td>查看JVM中选项，可以修改</td>
</tr>
<tr>
<td>getstatic</td>
<td>获取静态成员变量</td>
</tr>
<tr>
<td>ognl</td>
<td>执行一个ognl表达式</td>
</tr>
</tbody>
</table>
<h1 id="classclassloader相关命令之一" class="headerLink">
    <a href="#classclassloader%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4%e4%b9%8b%e4%b8%80" class="header-mark"></a>class/classloader相关命令之一</h1><h2 id="目标-5" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-5" class="header-mark"></a>目标</h2><ol>
<li>sc: Search Class</li>
<li>sm: Search Method</li>
</ol>
<h2 id="sc" class="headerLink">
    <a href="#sc" class="header-mark"></a>sc</h2><h3 id="作用-20" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-20" class="header-mark"></a>作用</h3><p>查看JVM已加载的类信息，“Search-Class” 的简写，这个命令能搜索出所有已经加载到 JVM 中的 Class 信息</p>
<p>sc 默认开启了子类匹配功能，也就是说所有当前类的子类也会被搜索出来，想要精确的匹配，请打开<code>options disable-sub-class true</code>开关</p>
<h3 id="参数说明-2" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-2" class="header-mark"></a>参数说明</h3><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配，支持全限定名，如com.taobao.test.AAA，也支持com/taobao/test/AAA这样的格式，这样，我们从异常堆栈里面把类名拷贝过来的时候，不需要在手动把<code>/</code>替换为<code>.</code>啦。</td>
</tr>
<tr>
<td><em>method-pattern</em></td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td>[d]</td>
<td>输出当前类的详细信息，包括这个类所加载的原始文件来源、类的声明、加载的ClassLoader等详细信息。 如果一个类被多个ClassLoader所加载，则会出现多次</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
<tr>
<td>[f]</td>
<td>输出当前类的成员变量信息（需要配合参数-d一起使用）</td>
</tr>
</tbody>
</table>
<h3 id="举例-7" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-7" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">模糊搜索，demo包下所有的类
</span></span><span class="line"><span class="cl">sc demo.*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">打印类的详细信息
</span></span><span class="line"><span class="cl">sc -d demo.MathGame
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310183345427.png" alt="image-20200310183345427" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">打印出类的Field信息
</span></span><span class="line"><span class="cl">sc -df demo.MathGame
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310183455546.png" alt="image-20200310183455546" style="zoom: 67%;" /> 
<h2 id="sm" class="headerLink">
    <a href="#sm" class="header-mark"></a>sm</h2><h3 id="作用-21" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-21" class="header-mark"></a>作用</h3><p>查看已加载类的方法信息</p>
<p>“Search-Method” 的简写，这个命令能搜索出所有已经加载了 Class 信息的方法信息。</p>
<p><code>sm</code> 命令只能看到由当前类所声明 (declaring) 的方法，父类则无法看到。</p>
<h3 id="参数说明-3" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-3" class="header-mark"></a>参数说明</h3><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td><em>method-pattern</em></td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td>[d]</td>
<td>展示每个方法的详细信息</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
</tbody>
</table>
<h3 id="举例-8" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-8" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">显示String类加载的方法
</span></span><span class="line"><span class="cl">sm java.lang.String
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310195834379.png" alt="image-20200310195834379" style="zoom:80%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">显示String中的toString方法详细信息
</span></span><span class="line"><span class="cl">sm -d java.lang.String toString
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310195915544.png" alt="image-20200310195915544" style="zoom:80%;" /> 
<h2 id="小结-9" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-9" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>与类相关的命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sc</td>
<td>Search Class 显示类相关的信息</td>
</tr>
<tr>
<td>sm</td>
<td>Search Method 显示方法相关的信息</td>
</tr>
</tbody>
</table>
<h1 id="classclassloader相关命令之二" class="headerLink">
    <a href="#classclassloader%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4%e4%b9%8b%e4%ba%8c" class="header-mark"></a>class/classloader相关命令之二</h1><h2 id="目标-6" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-6" class="header-mark"></a>目标</h2><ol>
<li>jad 把字节码文件反编译成源代码</li>
<li>mc 在内存中把源代码编译成字节码文件</li>
<li>redefine 把新生成的字节码文件在内存中执行</li>
</ol>
<h2 id="jad" class="headerLink">
    <a href="#jad" class="header-mark"></a>jad</h2><h3 id="作用-22" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-22" class="header-mark"></a>作用</h3><p>反编译指定已加载类源码</p>
<blockquote>
<p><code>jad</code> 命令将 JVM 中实际运行的 class 的 byte code 反编译成 java 代码，便于你理解业务逻辑；</p>
<p>在 Arthas Console 上，反编译出来的源码是带语法高亮的，阅读更方便</p>
<p>当然，反编译出来的 java 代码可能会存在语法错误，但不影响你进行阅读理解</p>
</blockquote>
<h3 id="参数说明-4" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-4" class="header-mark"></a>参数说明</h3><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
</tbody>
</table>
<h3 id="举例-9" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-9" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">编译java.lang.String
</span></span><span class="line"><span class="cl">jad java.lang.String
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">反编绎时只显示源代码，默认情况下，反编译结果里会带有ClassLoader信息，通过--source-only选项，可以只打印源代码。方便和mc/redefine命令结合使用。
</span></span><span class="line"><span class="cl">jad --source-only demo.MathGame
</span></span></code></pre></td></tr></table>
</div>
</div> <img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310214123430.png" alt="image-20200310214123430" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">反编译指定的函数
</span></span><span class="line"><span class="cl">jad demo.MathGame main
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310214327498.png" alt="image-20200310214327498" style="zoom: 67%;" /> 
<h2 id="mc" class="headerLink">
    <a href="#mc" class="header-mark"></a>mc</h2><h3 id="作用-23" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-23" class="header-mark"></a>作用</h3><p>Memory Compiler/内存编译器，编译<code>.java</code>文件生成<code>.class</code></p>
<h3 id="举例-10" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-10" class="header-mark"></a>举例</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">在内存中编译Hello.java为Hello.class
</span></span><span class="line"><span class="cl">mc /root/Hello.java
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">可以通过-d命令指定输出目录
</span></span><span class="line"><span class="cl">mc -d /root/bbb /root/Hello.java
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="效果-14" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-14" class="header-mark"></a>效果</h3><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310215259222.png" alt="image-20200310215259222" style="zoom:80%;" /> 
<h2 id="redefine" class="headerLink">
    <a href="#redefine" class="header-mark"></a>redefine</h2><h3 id="作用-24" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-24" class="header-mark"></a>作用</h3><p>加载外部的<code>.class</code>文件，redefine到JVM里</p>
<blockquote>
<p>注意， redefine后的原来的类不能恢复，redefine有可能失败（比如增加了新的field）。</p>
</blockquote>
<blockquote>
<p><code>reset</code>命令对<code>redefine</code>的类无效。如果想重置，需要<code>redefine</code>原始的字节码。</p>
</blockquote>
<blockquote>
<p><code>redefine</code>命令和<code>jad</code>/<code>watch</code>/<code>trace</code>/<code>monitor</code>/<code>tt</code>等命令会冲突。执行完<code>redefine</code>之后，如果再执行上面提到的命令，则会把<code>redefine</code>的字节码重置。</p>
</blockquote>
<h3 id="redefine的限制" class="headerLink">
    <a href="#redefine%e7%9a%84%e9%99%90%e5%88%b6" class="header-mark"></a>redefine的限制</h3><ul>
<li>不允许新增加field/method</li>
<li>正在跑的函数，没有退出不能生效，比如下面新增加的<code>System.out.println</code>，只有<code>run()</code>函数里的会生效</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MathGame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">MathGame</span> <span class="n">game</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MathGame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">game</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 这个不生效，因为代码一直跑在 while里
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;in loop&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 这个生效，因为run()函数每次都可以完整结束
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;call run()&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">primeFactors</span> <span class="o">=</span> <span class="n">primeFactors</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">print</span><span class="o">(</span><span class="n">number</span><span class="o">,</span> <span class="n">primeFactors</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&#34;illegalArgumentCount:%3d, &#34;</span><span class="o">,</span> <span class="n">illegalArgumentCount</span><span class="o">)</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="案例结合-jadmc-命令使用" class="headerLink">
    <a href="#%e6%a1%88%e4%be%8b%e7%bb%93%e5%90%88-jadmc-%e5%91%bd%e4%bb%a4%e4%bd%bf%e7%94%a8" class="header-mark"></a>案例：结合 jad/mc 命令使用</h3><h4 id="步骤-2" class="headerLink">
    <a href="#%e6%ad%a5%e9%aa%a4-2" class="header-mark"></a>步骤</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. 使用jad反编译demo.MathGame输出到/root/MathGame.java
</span></span><span class="line"><span class="cl">jad --source-only demo.MathGame &gt; /root/MathGame.java
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2.按上面的代码编辑完毕以后，使用mc内存中对新的代码编译
</span></span><span class="line"><span class="cl">mc /root/MathGame.java -d /root
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">3.使用redefine命令加载新的字节码
</span></span><span class="line"><span class="cl">redefine /root/demo/MathGame.class
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="结果" class="headerLink">
    <a href="#%e7%bb%93%e6%9e%9c" class="header-mark"></a>结果</h4><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310222846411.png" alt="image-20200310222846411" style="zoom: 67%;" /> 
<img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310222756483.png" alt="image-20200310222756483" style="zoom: 67%;" /> 
<h2 id="小结-10" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-10" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>类相关的命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>jad</td>
<td>反编译字节码文件得到java的源代码</td>
</tr>
<tr>
<td>mc</td>
<td>在内存中将源代码编译成字节码</td>
</tr>
<tr>
<td>redefine</td>
<td>将字节码文件重新加载到内存中执行</td>
</tr>
</tbody>
</table>
<h1 id="基础总结" class="headerLink">
    <a href="#%e5%9f%ba%e7%a1%80%e6%80%bb%e7%bb%93" class="header-mark"></a>基础总结</h1><ol>
<li>
<p>安装arthas的方法</p>
<p>既可以安装在windows下也可以安装在Linux</p>
<ol>
<li>在线安装</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -O https://alibaba.github.io/arthas/arthas-boot.jar
</span></span><span class="line"><span class="cl">java -jar arthas-boot.jar
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>
<p>离线安装</p>
<p>将从maven仓库中下载的zip包直接解压就可以使用</p>
</li>
<li>
<p>卸载方式</p>
<p>直接删除2个文件夹：.arthas和logs</p>
</li>
</ol>
</li>
<li>
<p>基础命令</p>
<table>
<thead>
<tr>
<th>基础命令</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>help</td>
<td>显示所有arthas命令，每个命令都可以使用-h的参数，显示它的参数信息</td>
</tr>
<tr>
<td>cat</td>
<td>显示文本文件内容</td>
</tr>
<tr>
<td>grep</td>
<td>对内容进行过滤，只显示关心的行</td>
</tr>
<tr>
<td>pwd</td>
<td>显示当前的工作路径</td>
</tr>
<tr>
<td>cls</td>
<td>清除屏幕</td>
</tr>
<tr>
<td>session</td>
<td>显示当前连接的会话ID</td>
</tr>
<tr>
<td>reset</td>
<td>重置arthas增强的类</td>
</tr>
<tr>
<td>version</td>
<td>显示当前arthas的版本号</td>
</tr>
<tr>
<td>quit</td>
<td>退出当前的会话</td>
</tr>
<tr>
<td>stop</td>
<td>结束arthas服务器，退出所有的会话</td>
</tr>
<tr>
<td>keymap</td>
<td>显示所有的快捷键</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>jvm相关命令</p>
<table>
<thead>
<tr>
<th>jvm相关命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>dashboard</td>
<td>仪表板，可以显示：线程，内存，堆栈，GC，Runtime等信息</td>
</tr>
<tr>
<td>thread</td>
<td>显示线程的堆栈</td>
</tr>
<tr>
<td>jvm</td>
<td>显示java虚拟机信息</td>
</tr>
<tr>
<td>sysprop</td>
<td>显示jvm中系统属性，也可以修改某个属性</td>
</tr>
<tr>
<td>sysenv</td>
<td>显示jvm中系统环境变量配置信息</td>
</tr>
<tr>
<td>vmoption</td>
<td>显示jvm中选项信息</td>
</tr>
<tr>
<td>getstatic</td>
<td>获取类中静态成员变量</td>
</tr>
<tr>
<td>ognl</td>
<td>执行一条ognl表达式，对象图导航语言</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>class和classloader相关命令</p>
<table>
<thead>
<tr>
<th>类，类加载相关的命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sc</td>
<td>Search Class 查看运行中的类信息</td>
</tr>
<tr>
<td>sm</td>
<td>Search Method 查看类中方法的信息</td>
</tr>
<tr>
<td>jad</td>
<td>反编译字节码为源代码</td>
</tr>
<tr>
<td>mc</td>
<td>Memory Compile 将源代码编译成字节码</td>
</tr>
<tr>
<td>redefine</td>
<td>将编译好的字节码文件加载到jvm中运行</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h1 id="arthas进阶" class="headerLink">
    <a href="#arthas%e8%bf%9b%e9%98%b6" class="header-mark"></a>《Arthas进阶》</h1><h1 id="学习目标" class="headerLink">
    <a href="#%e5%ad%a6%e4%b9%a0%e7%9b%ae%e6%a0%87" class="header-mark"></a>学习目标</h1><ol>
<li>类和类加载器相关的命令</li>
<li>monitor/watch/trace/stack等核心命令的使用</li>
<li>火焰图的生成</li>
<li>Arthas实战案例</li>
</ol>
<h1 id="dump" class="headerLink">
    <a href="#dump" class="header-mark"></a>dump</h1><h2 id="作用-25" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-25" class="header-mark"></a>作用</h2><p>将已加载类的字节码文件保存到特定目录：logs/arthas/classdump/</p>
<h3 id="参数" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0" class="header-mark"></a>参数</h3><table>
<thead>
<tr>
<th>数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td><code>[c:]</code></td>
<td>类所属 ClassLoader 的 hashcode</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
</tbody>
</table>
<h2 id="举例-11" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-11" class="header-mark"></a>举例</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">把String类的字节码文件保存到~/logs/arthas/classdump/目录下
</span></span><span class="line"><span class="cl">dump java.lang.String
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">把demo包下所有的类的字节码文件保存到~/logs/arthas/classdump/目录下
</span></span><span class="line"><span class="cl">dump demo.*
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="效果-15" class="headerLink">
    <a href="#%e6%95%88%e6%9e%9c-15" class="header-mark"></a>效果</h2><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png" title="image-20200310223714230" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223714230.png">
    </a></p>
<img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310223850169.png" alt="image-20200310223850169" style="zoom: 67%;" />  
<img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200310224236313.png" alt="image-20200310224236313" style="zoom:67%;" />
<h2 id="小结-11" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-11" class="header-mark"></a>小结</h2><p>dump作用：将正在JVM中运行的程序的字节码文件提取出来，保存在logs相应的目录下</p>
<p>不同的类加载器放在不同的目录下</p>
<h1 id="classloader" class="headerLink">
    <a href="#classloader" class="header-mark"></a>classloader</h1><h2 id="目标-7" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-7" class="header-mark"></a>目标</h2><p>获取类加载器的信息</p>
<h2 id="作用-26" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-26" class="header-mark"></a>作用</h2><ol>
<li>
<p><code>classloader</code> 命令将 JVM 中所有的classloader的信息统计出来，并可以展示继承树，urls等。</p>
</li>
<li>
<p>可以让指定的classloader去getResources，打印出所有查找到的resources的url。对于<code>ResourceNotFoundException</code>异常比较有用。</p>
</li>
</ol>
<h2 id="参数说明-5" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-5" class="header-mark"></a>参数说明</h2><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>[l]</td>
<td>按类加载实例进行统计</td>
</tr>
<tr>
<td>[t]</td>
<td>打印所有ClassLoader的继承树</td>
</tr>
<tr>
<td>[a]</td>
<td>列出所有ClassLoader加载的类，请谨慎使用</td>
</tr>
<tr>
<td><code>[c:]</code></td>
<td>ClassLoader的hashcode</td>
</tr>
<tr>
<td><code>[c: r:]</code></td>
<td>用ClassLoader去查找resource</td>
</tr>
<tr>
<td><code>[c: load:]</code></td>
<td>用ClassLoader去加载指定的类</td>
</tr>
</tbody>
</table>
<h2 id="举例-12" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-12" class="header-mark"></a>举例</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">默认按类加载器的类型查看统计信息
</span></span><span class="line"><span class="cl">classloader
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092606080.png" alt="image-20200311092606080" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">按类加载器的实例查看统计信息，可以看到类加载的hashCode
</span></span><span class="line"><span class="cl">classloader -l
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png" title="image-20200311092709402" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092709402.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">查看ClassLoader的继承树
</span></span><span class="line"><span class="cl">classloader -t
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311092759627.png" alt="image-20200311092759627" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">通过类加载器的hash，查看此类加载器实际所在的位置
</span></span><span class="line"><span class="cl">classloader -c 680f2737
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311093005661.png" alt="image-20200311093005661" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">使用ClassLoader去查找指定资源resource所在的位置
</span></span><span class="line"><span class="cl">classloader -c 680f2737 -r META-INF/MANIFEST.MF
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311093248859.png" alt="image-20200311093248859" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">使用ClassLoader去查找类的class文件所在的位置
</span></span><span class="line"><span class="cl">classloader -c 680f2737 -r java/lang/String.class
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311094534683.png" alt="image-20200311094534683" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">使用ClassLoader去加载类
</span></span><span class="line"><span class="cl">classloader -c 70dea4e --load java.lang.String
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311094910635.png" alt="image-20200311094910635" style="zoom:67%;" /> 
<h2 id="小结-12" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-12" class="header-mark"></a>小结</h2><p>classloader命令主要作用有哪些？</p>
<ol>
<li>显示所有类加载器的信息</li>
<li>获取某个类加载器所在的jar包</li>
<li>获取某个资源在哪个jar包中</li>
<li>加载某个类</li>
</ol>
<h1 id="monitor" class="headerLink">
    <a href="#monitor" class="header-mark"></a>monitor</h1><h2 id="目标-8" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-8" class="header-mark"></a>目标</h2><p>monitor命令：监控指定类中方法的执行情况</p>
<h2 id="作用-27" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-27" class="header-mark"></a>作用</h2><blockquote>
<p>对匹配 <code>class-pattern</code>／<code>method-pattern</code>的类、方法的调用进行监控。</p>
<p><code>monitor</code> 命令是一个非实时返回命令，实时返回命令是输入之后立即返回</p>
<p>而非实时返回的命令，则是不断的等待目标 Java 进程返回信息，直到用户输入 <code>Ctrl+C</code> 为止。</p>
</blockquote>
<h2 id="参数说明-6" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-6" class="header-mark"></a>参数说明</h2><p>方法拥有一个命名参数 <code>[c:]</code>，意思是统计周期（cycle of output），拥有一个整型的参数值</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td><em>method-pattern</em></td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
<tr>
<td><code>[c:]</code></td>
<td>统计周期，默认值为120秒</td>
</tr>
</tbody>
</table>
<h2 id="举例-13" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-13" class="header-mark"></a>举例</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">过5秒监控一次，类demo.MathGame中primeFactors方法
</span></span><span class="line"><span class="cl">monitor -c 5 demo.MathGame primeFactors
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png" title="image-20200311101017085" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311101017085.png">
    </a></p>
<h2 id="监控的维度说明" class="headerLink">
    <a href="#%e7%9b%91%e6%8e%a7%e7%9a%84%e7%bb%b4%e5%ba%a6%e8%af%b4%e6%98%8e" class="header-mark"></a>监控的维度说明</h2><table>
<thead>
<tr>
<th>监控项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>timestamp</td>
<td>时间戳</td>
</tr>
<tr>
<td>class</td>
<td>Java类</td>
</tr>
<tr>
<td>method</td>
<td>方法（构造方法、普通方法）</td>
</tr>
<tr>
<td>total</td>
<td>调用次数</td>
</tr>
<tr>
<td>success</td>
<td>成功次数</td>
</tr>
<tr>
<td>fail</td>
<td>失败次数</td>
</tr>
<tr>
<td>rt</td>
<td>平均耗时</td>
</tr>
<tr>
<td>fail-rate</td>
<td>失败率</td>
</tr>
</tbody>
</table>
<h2 id="小结-13" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-13" class="header-mark"></a>小结</h2><p>monitor命令的作用是什么？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">用来监视一个时间段中指定方法的执行次数，成功次数，失败次数，耗时等这些信息
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="watch" class="headerLink">
    <a href="#watch" class="header-mark"></a>watch</h1><h2 id="目标-9" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-9" class="header-mark"></a>目标</h2><p>观察到指定方法的调用情况</p>
<h2 id="作用-28" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-28" class="header-mark"></a>作用</h2><blockquote>
<p>方法执行数据观测，让你能方便的观察到指定方法的调用情况。</p>
<p>能观察到的范围为：<code>返回值</code>、<code>抛出异常</code>、<code>入参</code>，通过编写OGNL 表达式进行对应变量的查看。</p>
</blockquote>
<h2 id="参数说明-7" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-7" class="header-mark"></a>参数说明</h2><p>watch 的参数比较多，主要是因为它能在 4 个不同的场景观察对象</p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td><em>method-pattern</em></td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td><em>express</em></td>
<td>观察表达式</td>
</tr>
<tr>
<td><em>condition-express</em></td>
<td>条件表达式</td>
</tr>
<tr>
<td>[b]</td>
<td>在<strong>方法调用之前</strong>观察 before</td>
</tr>
<tr>
<td>[e]</td>
<td>在<strong>方法异常之后</strong>观察 exception</td>
</tr>
<tr>
<td>[s]</td>
<td>在<strong>方法返回之后</strong>观察 success</td>
</tr>
<tr>
<td>[f]</td>
<td>在<strong>方法结束之后</strong>(正常返回和异常返回)观察  finish</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
<tr>
<td>[x:]</td>
<td>指定输出结果的属性遍历深度，默认为 1</td>
</tr>
</tbody>
</table>
<p>这里重点要说明的是观察表达式，观察表达式的构成主要由ognl 表达式组成，所以你可以这样写<code>&quot;{params,returnObj}&quot;</code>，只要是一个合法的 ognl 表达式，都能被正常支持。</p>
<h3 id="特别说明" class="headerLink">
    <a href="#%e7%89%b9%e5%88%ab%e8%af%b4%e6%98%8e" class="header-mark"></a>特别说明</h3><ul>
<li>watch 命令定义了4个观察事件点，即 <code>-b</code> 方法调用前，<code>-e</code> 方法异常后，<code>-s</code> 方法返回后，<code>-f</code> 方法结束后</li>
<li>4个观察事件点 <code>-b</code>、<code>-e</code>、<code>-s</code> 默认关闭，<code>-f</code> 默认打开，当指定观察点被打开后，在相应事件点会对观察表达式进行求值并输出</li>
<li>这里要注意<code>方法入参</code>和<code>方法出参</code>的区别，有可能在中间被修改导致前后不一致，除了 <code>-b</code> 事件点 <code>params</code> 代表方法入参外，其余事件都代表方法出参</li>
<li>当使用 <code>-b</code> 时，由于观察事件点是在方法调用前，此时返回值或异常均不存在</li>
</ul>
<h2 id="举例-14" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-14" class="header-mark"></a>举例</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">观察demo.MathGame类中primeFactors方法出参和返回值，结果属性遍历深度为2。
</span></span><span class="line"><span class="cl">params表示所有参数数组(因为不确定是几个参数)，returnObject表示返回值
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">watch demo.MathGame primeFactors &#34;{params,returnObj}&#34; -x 2
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311103008904.png" alt="image-20200311103008904" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">观察方法入参，对比前一个例子，返回值为空（事件点为方法执行前，因此获取不到返回值）
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">watch demo.MathGame primeFactors &#34;{params,returnObj}&#34; -x 2 -b
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311152248842.png" alt="image-20200311152248842" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">观察当前对象中的属性，如果想查看方法运行前后，当前对象中的属性，可以使用target关键字，代表当前对象
</span></span><span class="line"><span class="cl">watch demo.MathGame primeFactors &#39;target&#39; -x 2
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311153804431.png" alt="image-20200311153804431" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">同时观察方法调用前和方法返回后，参数里-n 2，表示只执行两次。
</span></span><span class="line"><span class="cl">这里输出结果中，第一次输出的是方法调用前的观察表达式的结果，第二次输出的是方法返回后的表达式的结果
</span></span><span class="line"><span class="cl">params表示参数，target表示执行方法的对象，returnObject表示返回值
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">watch demo.MathGame primeFactors &#34;{params,target,returnObj}&#34; -x 2 -b -s -n 2
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311153004991.png" alt="image-20200311153004991" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">使用target.field_name访问当前对象的某个属性
</span></span><span class="line"><span class="cl">watch demo.MathGame primeFactors &#39;target.illegalArgumentCount&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311154005898.png" alt="image-20200311154005898" style="zoom:80%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">条件表达式的例子，输出第1参数小于的情况
</span></span><span class="line"><span class="cl">watch demo.MathGame primeFactors &#34;{params[0],target}&#34; &#34;params[0]&lt;0&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311155053465.png" alt="image-20200311155053465" style="zoom:80%;" /> 
<h2 id="小结-14" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-14" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>[b]</td>
<td>begin 监视方法执行前的情况</td>
</tr>
<tr>
<td>[e]</td>
<td>exception 监视出现异常的情况</td>
</tr>
<tr>
<td>[s]</td>
<td>success 执行成功的情况</td>
</tr>
<tr>
<td>[f]</td>
<td>finish 执行完毕的情况，包含成功或失败</td>
</tr>
</tbody>
</table>
<h1 id="trace" class="headerLink">
    <a href="#trace" class="header-mark"></a>trace</h1><h2 id="目标-10" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-10" class="header-mark"></a>目标</h2><p>学习trace这条命令的使用</p>
<p>对方法内部调用路径进行追踪，并输出方法路径上的每个节点上耗时</p>
<h2 id="介绍" class="headerLink">
    <a href="#%e4%bb%8b%e7%bb%8d" class="header-mark"></a>介绍</h2><blockquote>
<p><code>trace</code> 命令能主动搜索 <code>class-pattern</code>／<code>method-pattern</code> 对应的方法调用路径，渲染和统计整个调用链路上的所有性能开销和追踪调用链路。</p>
<p>观察表达式的构成主要由ognl 表达式组成，所以你可以这样写<code>&quot;{params,returnObj}&quot;</code>，只要是一个合法的 ognl 表达式，都能被正常支持。</p>
<p>很多时候我们只想看到某个方法的rt大于某个时间之后的trace结果，现在Arthas可以按照方法执行的耗时来进行过滤了，例如<code>trace *StringUtils isBlank '#cost&gt;100'</code>表示当执行时间超过100ms的时候，才会输出trace的结果。</p>
<p>watch/stack/trace这个三个命令都支持<code>#cost</code>耗时条件过滤</p>
</blockquote>
<h2 id="参数说明-8" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-8" class="header-mark"></a>参数说明</h2><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达匹配</td>
</tr>
<tr>
<td><em>method-pattern</em></td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td><em>condition-express</em></td>
<td>条件表达式，使用OGNL表达式</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认是通配符匹配</td>
</tr>
<tr>
<td><code>[n:]</code></td>
<td>设置命令执行次数</td>
</tr>
<tr>
<td><code>#cost</code></td>
<td>方法执行耗时，单位是毫秒</td>
</tr>
</tbody>
</table>
<h2 id="举例-15" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-15" class="header-mark"></a>举例</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">trace函数指定类的指定方法
</span></span><span class="line"><span class="cl">trace demo.MathGame run
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png" title="image-20200311171209739" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171209739.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">如果方法调用的次数很多，那么可以用-n参数指定捕捉结果的次数。比如下面的例子里，捕捉到一次调用就退出命令。
</span></span><span class="line"><span class="cl">trace demo.MathGame run -n 1
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png" title="image-20200311171239100" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171239100.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">默认情况下，trace不会包含jdk里的函数调用，如果希望trace jdk里的函数，需要显式设置--skipJDKMethod false。
</span></span><span class="line"><span class="cl">trace --skipJDKMethod false demo.MathGame run
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png" title="image-20200311171325682" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171325682.png">
    </a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">据调用耗时过滤，trace大于0.5ms的调用路径
</span></span><span class="line"><span class="cl">trace demo.MathGame run &#39;#cost &gt; .5&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311171441982.png" alt="image-20200311171441982" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">可以用正则表匹配路径上的多个类和函数，一定程度上达到多层trace的效果。
</span></span><span class="line"><span class="cl">trace -E com.test.ClassA|org.test.ClassB method1|method2|method3
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="小结-15" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-15" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>class-pattern</td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td>method-pattern</td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td>condition-express</td>
<td>条件表达式</td>
</tr>
<tr>
<td>#cost</td>
<td>过滤条件，只追踪满足的耗时方法</td>
</tr>
</tbody>
</table>
<h1 id="stack" class="headerLink">
    <a href="#stack" class="header-mark"></a>stack</h1><h2 id="作用-29" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-29" class="header-mark"></a>作用</h2><p>输出当前方法被调用的调用路径</p>
<h2 id="介绍-1" class="headerLink">
    <a href="#%e4%bb%8b%e7%bb%8d-1" class="header-mark"></a>介绍</h2><blockquote>
<p>很多时候我们都知道一个方法被执行，但这个方法被执行的路径非常多，或者你根本就不知道这个方法是从那里被执行了，此时你需要的是 stack 命令。</p>
</blockquote>
<h2 id="参数说明-9" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e-9" class="header-mark"></a>参数说明</h2><table>
<thead>
<tr>
<th>参数名称</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>class-pattern</em></td>
<td>类名表达式匹配</td>
</tr>
<tr>
<td><em>method-pattern</em></td>
<td>方法名表达式匹配</td>
</tr>
<tr>
<td><em>condition-express</em></td>
<td>条件表达式，OGNL</td>
</tr>
<tr>
<td>[E]</td>
<td>开启正则表达式匹配，默认为通配符匹配</td>
</tr>
<tr>
<td><code>[n:]</code></td>
<td>执行次数限制</td>
</tr>
</tbody>
</table>
<h2 id="举例-16" class="headerLink">
    <a href="#%e4%b8%be%e4%be%8b-16" class="header-mark"></a>举例</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">获取primeFactors的调用路径
</span></span><span class="line"><span class="cl">stack demo.MathGame primeFactors
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311173954382.png" alt="image-20200311173954382" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">条件表达式来过滤，第0个参数的值小于0，-n表示获取2次
</span></span><span class="line"><span class="cl">stack demo.MathGame primeFactors &#39;params[0]&lt;0&#39; -n 2
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311174229013.png" alt="image-20200311174229013" style="zoom: 67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">据执行时间来过滤，耗时大于0.5毫秒
</span></span><span class="line"><span class="cl">stack demo.MathGame primeFactors &#39;#cost&gt;0.5&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311174408523.png" alt="image-20200311174408523" style="zoom:67%;" /> 
<h2 id="小结-16" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-16" class="header-mark"></a>小结</h2><p>stack命令的作用是什么？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">输出当前方法被调用的路径
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="tt" class="headerLink">
    <a href="#tt" class="header-mark"></a>tt</h1><h2 id="作用-30" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-30" class="header-mark"></a>作用</h2><p>time-tunnel 时间隧道</p>
<p>记录下指定方法每次调用的入参和返回信息，并能对这些不同时间下调用的信息进行观测</p>
<h2 id="介绍-2" class="headerLink">
    <a href="#%e4%bb%8b%e7%bb%8d-2" class="header-mark"></a>介绍</h2><blockquote>
<p><code>watch</code> 虽然很方便和灵活，但需要提前想清楚观察表达式的拼写，这对排查问题而言要求太高，因为很多时候我们并不清楚问题出自于何方，只能靠蛛丝马迹进行猜测。</p>
<p>这个时候如果能记录下当时方法调用的所有入参和返回值、抛出的异常会对整个问题的思考与判断非常有帮助。</p>
<p>于是乎，TimeTunnel 命令就诞生了。</p>
</blockquote>
<h2 id="参数解析" class="headerLink">
    <a href="#%e5%8f%82%e6%95%b0%e8%a7%a3%e6%9e%90" class="header-mark"></a>参数解析</h2><table>
<thead>
<tr>
<th>tt的参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-t</td>
<td>记录某个方法在一个时间段中的调用</td>
</tr>
<tr>
<td>-l</td>
<td>显示所有已经记录的列表</td>
</tr>
<tr>
<td>-n 次数</td>
<td>只记录多少次</td>
</tr>
<tr>
<td>-s 表达式</td>
<td>搜索表达式</td>
</tr>
<tr>
<td>-i 索引号</td>
<td>查看指定索引号的详细调用信息</td>
</tr>
<tr>
<td>-p</td>
<td>重新调用指定的索引号时间碎片</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><code>-t</code></p>
<p>tt 命令有很多个主参数，<code>-t</code> 就是其中之一。这个参数表明希望记录下类 <code>*Test</code> 的 <code>print</code> 方法的每次执行情况。</p>
</li>
<li>
<p><code>-n 3</code></p>
<p>当你执行一个调用量不高的方法时可能你还能有足够的时间用 <code>CTRL+C</code> 中断 tt 命令记录的过程，但如果遇到调用量非常大的方法，瞬间就能将你的 JVM 内存撑爆。</p>
<p>此时你可以通过 <code>-n</code> 参数指定你需要记录的次数，当达到记录次数时 Arthas 会主动中断tt命令的记录过程，避免人工操作无法停止的情况。</p>
</li>
</ul>
<h2 id="使用案例" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8%e6%a1%88%e4%be%8b" class="header-mark"></a>使用案例</h2><h3 id="基本使用" class="headerLink">
    <a href="#%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8" class="header-mark"></a>基本使用</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">最基本的使用来说，就是记录下当前方法的每次调用环境现场。
</span></span><span class="line"><span class="cl">tt -t demo.MathGame primeFactors
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png" title="image-20200321200911157" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321200911157.png">
    </a></p>
<h3 id="表格字段说明" class="headerLink">
    <a href="#%e8%a1%a8%e6%a0%bc%e5%ad%97%e6%ae%b5%e8%af%b4%e6%98%8e" class="header-mark"></a>表格字段说明</h3><table>
<thead>
<tr>
<th>表格字段</th>
<th>字段解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>INDEX</td>
<td>时间片段记录编号，每一个编号代表着一次调用，后续tt还有很多命令都是基于此编号指定记录操作，非常重要。</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>方法执行的本机时间，记录了这个时间片段所发生的本机时间</td>
</tr>
<tr>
<td>COST(ms)</td>
<td>方法执行的耗时</td>
</tr>
<tr>
<td>IS-RET</td>
<td>方法是否以正常返回的形式结束</td>
</tr>
<tr>
<td>IS-EXP</td>
<td>方法是否以抛异常的形式结束</td>
</tr>
<tr>
<td>OBJECT</td>
<td>执行对象的<code>hashCode()</code>，注意，曾经有人误认为是对象在JVM中的内存地址，但很遗憾他不是。但他能帮助你简单的标记当前执行方法的类实体</td>
</tr>
<tr>
<td>CLASS</td>
<td>执行的类名</td>
</tr>
<tr>
<td>METHOD</td>
<td>执行的方法名</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>条件表达式</p>
<p>不知道大家是否有在使用过程中遇到以下困惑</p>
<ul>
<li>Arthas 似乎很难区分出重载的方法</li>
<li>我只需要观察特定参数，但是 tt 却全部都给我记录了下来</li>
</ul>
<p>条件表达式也是用 <code>OGNL</code> 来编写，核心的判断对象依然是 <code>Advice</code> 对象。除了 <code>tt</code> 命令之外，<code>watch</code>、<code>trace</code>、<code>stack</code> 命令也都支持条件表达式。</p>
</li>
<li>
<p>解决方法重载</p>
<p><code>tt -t *Test print params.length==1</code></p>
<p>通过制定参数个数的形式解决不同的方法签名，如果参数个数一样，你还可以这样写</p>
<p><code>tt -t *Test print 'params[1] instanceof Integer'</code></p>
</li>
<li>
<p>解决指定参数</p>
<p><code>tt -t *Test print params[0].mobile==&quot;13989838402&quot;</code></p>
</li>
</ul>
<h3 id="检索调用记录" class="headerLink">
    <a href="#%e6%a3%80%e7%b4%a2%e8%b0%83%e7%94%a8%e8%ae%b0%e5%bd%95" class="header-mark"></a>检索调用记录</h3><p>当你用 <code>tt</code> 记录了一大片的时间片段之后，你希望能从中筛选出自己需要的时间片段，这个时候你就需要对现有记录进行检索。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tt -l
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png" title="image-20200321194350208" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194350208.png">
    </a></p>
<p>需要筛选出 <code>primeFactors</code> 方法的调用信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tt -s &#39;method.name==&#34;primeFactors&#34;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png" title="image-20200321194724694" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321194724694.png">
    </a></p>
<h3 id="查看调用信息" class="headerLink">
    <a href="#%e6%9f%a5%e7%9c%8b%e8%b0%83%e7%94%a8%e4%bf%a1%e6%81%af" class="header-mark"></a>查看调用信息</h3><p>对于具体一个时间片的信息而言，你可以通过 <code>-i</code> 参数后边跟着对应的 <code>INDEX</code> 编号查看到他的详细信息。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tt -i 1002
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321201648590.png" alt="image-20200321201648590" style="zoom:80%;" /> 
<h3 id="重做一次调用" class="headerLink">
    <a href="#%e9%87%8d%e5%81%9a%e4%b8%80%e6%ac%a1%e8%b0%83%e7%94%a8" class="header-mark"></a>重做一次调用</h3><p>当你稍稍做了一些调整之后，你可能需要前端系统重新触发一次你的调用，此时得求爷爷告奶奶的需要前端配合联调的同学再次发起一次调用。而有些场景下，这个调用不是这么好触发的。</p>
<p><code>tt</code> 命令由于保存了当时调用的所有现场信息，所以我们可以自己主动对一个 <code>INDEX</code> 编号的时间片自主发起一次调用，从而解放你的沟通成本。此时你需要 <code>-p</code> 参数。通过 <code>--replay-times</code> 指定 调用次数，通过 <code>--replay-interval</code> 指定多次调用间隔(单位ms, 默认1000ms)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tt -i 1002 -p
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200321195211743.png" alt="image-20200321195211743" style="zoom:80%;" /> 
<h2 id="小结-17" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-17" class="header-mark"></a>小结</h2><p>作用：记录指定方法每次调用的入参和返回值，并后期还可以对这些信息进行观测</p>
<table>
<thead>
<tr>
<th>tt的参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-t</td>
<td>记录方法在一个时间段中调用</td>
</tr>
<tr>
<td>-l</td>
<td>显示所有已经记录的列表</td>
</tr>
<tr>
<td>-n 次数</td>
<td>只记录多少次</td>
</tr>
<tr>
<td>-s 搜索表达式</td>
<td>指定搜索表达式</td>
</tr>
<tr>
<td>-i 索引号</td>
<td>查看它的详细信息</td>
</tr>
</tbody>
</table>
<h1 id="options" class="headerLink">
    <a href="#options" class="header-mark"></a>options</h1><h2 id="作用-31" class="headerLink">
    <a href="#%e4%bd%9c%e7%94%a8-31" class="header-mark"></a>作用</h2><blockquote>
<p>全局开关</p>
</blockquote>
<h2 id="全局选项" class="headerLink">
    <a href="#%e5%85%a8%e5%b1%80%e9%80%89%e9%a1%b9" class="header-mark"></a>全局选项</h2><table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>unsafe</td>
<td>false</td>
<td>是否支持对系统级别的类进行增强，打开该开关可能导致把JVM搞挂，请慎重选择！</td>
</tr>
<tr>
<td>dump</td>
<td>false</td>
<td>是否支持被增强了的类dump到外部文件中，如果打开开关，class文件会被dump到<code>/${application dir}/arthas-class-dump/</code>目录下，具体位置详见控制台输出</td>
</tr>
<tr>
<td>batch-re-transform</td>
<td>true</td>
<td>是否支持批量对匹配到的类执行retransform操作</td>
</tr>
<tr>
<td>json-format</td>
<td>false</td>
<td>是否支持json化的输出</td>
</tr>
<tr>
<td>disable-sub-class</td>
<td>false</td>
<td>是否禁用子类匹配，默认在匹配目标类的时候会默认匹配到其子类，如果想精确匹配，可以关闭此开关</td>
</tr>
<tr>
<td>debug-for-asm</td>
<td>false</td>
<td>打印ASM相关的调试信息</td>
</tr>
<tr>
<td>save-result</td>
<td>false</td>
<td>是否打开执行结果存日志功能，打开之后所有命令的运行结果都将保存到<code>~/logs/arthas-cache/result.log</code>中</td>
</tr>
<tr>
<td>job-timeout</td>
<td>1d</td>
<td>异步后台任务的默认超时时间，超过这个时间，任务自动停止；比如设置 1d, 2h, 3m, 25s，分别代表天、小时、分、秒</td>
</tr>
<tr>
<td>print-parent-fields</td>
<td>true</td>
<td>是否打印在parent class里的filed</td>
</tr>
</tbody>
</table>
<h2 id="案例" class="headerLink">
    <a href="#%e6%a1%88%e4%be%8b" class="header-mark"></a>案例</h2><h3 id="查看所有的options" class="headerLink">
    <a href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89%e7%9a%84options" class="header-mark"></a>查看所有的options</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">options
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png" title="image-20200322092041440" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092041440.png">
    </a></p>
<h3 id="获取option的值" class="headerLink">
    <a href="#%e8%8e%b7%e5%8f%96option%e7%9a%84%e5%80%bc" class="header-mark"></a>获取option的值</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">options json-format
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png" title="image-20200322092136758" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092136758.png">
    </a></p>
<h3 id="设置指定的option" class="headerLink">
    <a href="#%e8%ae%be%e7%bd%ae%e6%8c%87%e5%ae%9a%e7%9a%84option" class="header-mark"></a>设置指定的option</h3><p>例如，想打开执行结果存日志功能，输入如下命令即可：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">options save-result true
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png" title="image-20200322092300964" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322092300964.png">
    </a></p>
<h2 id="小结-18" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-18" class="header-mark"></a>小结</h2><p>options的作用是：查看或设置arthas全局环境变量</p>
<h1 id="profiler火焰图" class="headerLink">
    <a href="#profiler%e7%81%ab%e7%84%b0%e5%9b%be" class="header-mark"></a>profiler火焰图</h1><h2 id="目标-11" class="headerLink">
    <a href="#%e7%9b%ae%e6%a0%87-11" class="header-mark"></a>目标</h2><p>生成火焰图</p>
<h2 id="介绍-3" class="headerLink">
    <a href="#%e4%bb%8b%e7%bb%8d-3" class="header-mark"></a>介绍</h2><p><code>profiler</code> 命令支持生成应用热点的火焰图。本质上是通过不断的采样，然后把收集到的采样结果生成火焰图。</p>
<p>命令基本运行结构是 <code>profiler 命令 [命令参数]</code></p>
<h2 id="案例-1" class="headerLink">
    <a href="#%e6%a1%88%e4%be%8b-1" class="header-mark"></a>案例</h2><h3 id="启动profiler" class="headerLink">
    <a href="#%e5%90%af%e5%8a%a8profiler" class="header-mark"></a>启动profiler</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler start
</span></span><span class="line"><span class="cl">Started [cpu] profiling
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>默认情况下，生成的是cpu的火焰图，即event为<code>cpu</code>。可以用<code>--event</code>参数来指定。</p>
</blockquote>
<h3 id="显示支持的事件" class="headerLink">
    <a href="#%e6%98%be%e7%a4%ba%e6%94%af%e6%8c%81%e7%9a%84%e4%ba%8b%e4%bb%b6" class="header-mark"></a>显示支持的事件</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler list
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="获取已采集的sample的数量" class="headerLink">
    <a href="#%e8%8e%b7%e5%8f%96%e5%b7%b2%e9%87%87%e9%9b%86%e7%9a%84sample%e7%9a%84%e6%95%b0%e9%87%8f" class="header-mark"></a>获取已采集的sample的数量</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler getSamples
</span></span><span class="line"><span class="cl">23
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="查看profiler状态" class="headerLink">
    <a href="#%e6%9f%a5%e7%9c%8bprofiler%e7%8a%b6%e6%80%81" class="header-mark"></a>查看profiler状态</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler status
</span></span><span class="line"><span class="cl">[cpu] profiling is running for 4 seconds
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以查看当前profiler在采样哪种<code>event</code>和采样时间。</p>
<h3 id="停止profiler" class="headerLink">
    <a href="#%e5%81%9c%e6%ad%a2profiler" class="header-mark"></a>停止profiler</h3><h4 id="生成svg格式结果" class="headerLink">
    <a href="#%e7%94%9f%e6%88%90svg%e6%a0%bc%e5%bc%8f%e7%bb%93%e6%9e%9c" class="header-mark"></a>生成svg格式结果</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler stop
</span></span><span class="line"><span class="cl">profiler output file: /tmp/demo/arthas-output/20191125-135546.svg
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><p>默认情况下，生成的结果保存到应用的<code>工作目录</code>下的<code>arthas-output</code>目录。可以通过 <code>--file</code>参数来指定输出结果路径。比如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler stop --file /tmp/output.svg
</span></span><span class="line"><span class="cl">profiler output file: /tmp/output.svg
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="生成html格式结果" class="headerLink">
    <a href="#%e7%94%9f%e6%88%90html%e6%a0%bc%e5%bc%8f%e7%bb%93%e6%9e%9c" class="header-mark"></a>生成html格式结果</h4><p>默认情况下，结果文件是<code>svg</code>格式，如果想生成<code>html</code>格式，可以用<code>--format</code>参数指定：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ profiler stop --format html
</span></span><span class="line"><span class="cl">profiler output file: /tmp/test/arthas-output/20191125-143329.html
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></td></tr></table>
</div>
</div><p>或者在<code>--file</code>参数里用文件名指名格式。比如<code>--file /tmp/result.html</code> 。</p>
<h3 id="通过浏览器查看arthas-output下面的profiler结果" class="headerLink">
    <a href="#%e9%80%9a%e8%bf%87%e6%b5%8f%e8%a7%88%e5%99%a8%e6%9f%a5%e7%9c%8barthas-output%e4%b8%8b%e9%9d%a2%e7%9a%84profiler%e7%bb%93%e6%9e%9c" class="header-mark"></a>通过浏览器查看arthas-output下面的profiler结果</h3><p>默认情况下，arthas使用3658端口，则可以打开： http://localhost:3658/arthas-output/ 查看到<code>arthas-output</code>目录下面的profiler结果：</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png" title="image-20200322095520034" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095520034.png">
    </a></p>
<p>点击可以查看具体的结果：</p>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png" title="image-20200322095504907" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322095504907.png">
    </a></p>
<h2 id="火焰图的含义" class="headerLink">
    <a href="#%e7%81%ab%e7%84%b0%e5%9b%be%e7%9a%84%e5%90%ab%e4%b9%89" class="header-mark"></a>火焰图的含义</h2><p>火焰图是基于 perf 结果产生的SVG 图片，用来展示 CPU 的调用栈。</p>
<blockquote>
<p>y 轴表示调用栈，每一层都是一个函数。调用栈越深，火焰就越高，顶部就是正在执行的函数，下方都是它的父函数。</p>
<p>x 轴表示抽样数，如果一个函数在 x 轴占据的宽度越宽，就表示它被抽到的次数多，即执行的时间长。注意，x 轴不代表时间，而是所有的调用栈合并后，按字母顺序排列的。</p>
<p><strong>火焰图就是看顶层的哪个函数占据的宽度最大。只要有&quot;平顶&quot;（plateaus），就表示该函数可能存在性能问题。</strong></p>
<p>颜色没有特殊含义，因为火焰图表示的是 CPU 的繁忙程度，所以一般选择暖色调。</p>
</blockquote>
<h2 id="小结-19" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93-19" class="header-mark"></a>小结</h2><table>
<thead>
<tr>
<th>profiler</th>
<th>命令作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>profiler start</td>
<td>启动profiler，默认情况下，生成cpu的火焰图</td>
</tr>
<tr>
<td>profiler list</td>
<td>显示所有支持的事件</td>
</tr>
<tr>
<td>profiler getSamples</td>
<td>获取已采集的sample的数量</td>
</tr>
<tr>
<td>profiler status</td>
<td>查看profiler的状态，运行的时间</td>
</tr>
<tr>
<td>profiler stop</td>
<td>停止profiler，生成火焰图的结果，指定输出目录和输出格式：svg或html</td>
</tr>
</tbody>
</table>
<h1 id="arthas实践" class="headerLink">
    <a href="#arthas%e5%ae%9e%e8%b7%b5" class="header-mark"></a>Arthas实践</h1><h2 id="需求" class="headerLink">
    <a href="#%e9%9c%80%e6%b1%82" class="header-mark"></a>需求</h2><h3 id="1-哪个controller处理了请求" class="headerLink">
    <a href="#1-%e5%93%aa%e4%b8%aacontroller%e5%a4%84%e7%90%86%e4%ba%86%e8%af%b7%e6%b1%82" class="header-mark"></a>1. 哪个Controller处理了请求</h3><p>我们可以快速定位一个请求是被哪些<code>Filter</code>拦截的，或者请求最终是由哪些<code>Servlet</code>处理的。但有时，我们想知道一个请求是被哪个Spring MVC Controller处理的。如果翻代码的话，会比较难找，并且不一定准确。通过Arthas可以精确定位是哪个<code>Controller</code>处理请求。</p>
<h3 id="2-每个请求的调用参数和返回值是多少" class="headerLink">
    <a href="#2-%e6%af%8f%e4%b8%aa%e8%af%b7%e6%b1%82%e7%9a%84%e8%b0%83%e7%94%a8%e5%8f%82%e6%95%b0%e5%92%8c%e8%bf%94%e5%9b%9e%e5%80%bc%e6%98%af%e5%a4%9a%e5%b0%91" class="header-mark"></a>2. 每个请求的调用参数和返回值是多少</h3><p>通过watch来查看请求的参数和返回值</p>
<h2 id="准备场景" class="headerLink">
    <a href="#%e5%87%86%e5%a4%87%e5%9c%ba%e6%99%af" class="header-mark"></a>准备场景</h2><p>将ssm_student.war项目部署到Linux的tomcat服务器下，可以正常访问。</p>
<p>启动之后，访问：http://192.168.254.199:8080/ssm_student ，会返回如下页面。192.168.254.199 是Linux服务器的地址。</p>
<p>那么这个请求是被哪个<code>Controller</code>处理的呢？</p>
<img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311201333701.png" alt="image-20200311201333701" style="zoom: 80%;" /> 
<h2 id="步骤-3" class="headerLink">
    <a href="#%e6%ad%a5%e9%aa%a4-3" class="header-mark"></a>步骤</h2><ol>
<li>trace定位DispatcherServlet</li>
<li>jad反编译DispatcherServlet</li>
<li>watch定位handler</li>
<li>使用watch得到方法的入参和返回值</li>
</ol>
<h2 id="实现步骤" class="headerLink">
    <a href="#%e5%ae%9e%e7%8e%b0%e6%ad%a5%e9%aa%a4" class="header-mark"></a>实现步骤</h2><p>第1步：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">在浏览器上进行登录操作，检查最耗时的方法
</span></span><span class="line"><span class="cl">trace *.DispatcherServlet *
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210304299.png" alt="image-20200311210304299" style="zoom:80%;" />  
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">可以分步trace，请求最终是被DispatcherServlet#doDispatch()处理了
</span></span><span class="line"><span class="cl">trace *.FrameworkServlet doService
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png" title="image-20200311210115377" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210115377.png">
    </a></p>
<p>第2步：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">trace结果里把调用的行号打印出来了，我们可以直接在IDE里查看代码（也可以用jad命令反编译）
</span></span><span class="line"><span class="cl">jad --source-only *.DispatcherServlet doDispatch
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210459511.png" alt="image-20200311210459511" style="zoom: 67%;" />
<p>第3步：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">watch *.DispatcherServlet getHandler &#39;returnObj&#39;
</span></span><span class="line"><span class="cl">查看返回的结果，得到使用到了2个控制器的方法
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png" title="image-20200311210600265" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200311210600265.png">
    </a></p>
<p>第4步：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">watch com.itheima.controller.* * {params,returnObj} -x 2
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/image-20200322110452326.png" alt="image-20200322110452326" style="zoom:80%;" /> 
<h2 id="结论" class="headerLink">
    <a href="#%e7%bb%93%e8%ae%ba" class="header-mark"></a>结论</h2><p>通过trace, jad, watch最后得到这个操作由2个控制器来处理，分别是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">com.itheima.controller.UserController.login()
</span></span><span class="line"><span class="cl">com.itheima.controller.StudentController.findAll()
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="学习总结" class="headerLink">
    <a href="#%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93" class="header-mark"></a>学习总结</h1><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>dump</td>
<td>将已加载类的字节码文件保存到特定的目录中</td>
</tr>
<tr>
<td>classloader</td>
<td>获取类加载器的信息</td>
</tr>
<tr>
<td>monitor</td>
<td>监控指定类中方法的执行情况</td>
</tr>
<tr>
<td>watch</td>
<td>观察到指定方法的调用情况</td>
</tr>
<tr>
<td>trace</td>
<td>对方法内部调用路径进行追踪，并输出方法路径上每个节点上耗时</td>
</tr>
<tr>
<td>stack</td>
<td>输出当前方法被调用的路径</td>
</tr>
<tr>
<td>tt</td>
<td>记录指定方法每次调用的入参和返回信息</td>
</tr>
<tr>
<td>options</td>
<td>全局开关</td>
</tr>
<tr>
<td>profiler</td>
<td>生成火焰图</td>
</tr>
</tbody>
</table>
<p><a class="lightgallery" href="https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png" title="arthas命令列表" data-thumbnail="https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png">
        <img
            
            loading="lazy"
            src="https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png"
            srcset="https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png, https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png 1.5x, https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png 2x"
            sizes="auto"
            alt="https://blog-1257196793.cos.ap-beijing.myqcloud.com/arthas%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8.png">
    </a></p>
</div>

        

<div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2023-03-20</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/arthas-%E9%BB%91%E9%A9%AC/index.md target="_blank" rel="noopener noreferrer">阅读原始文档</a>
                    </span></div>
            <div class="post-info-share">
                <span><a href="#" title="分享到 Twitter" data-sharer="twitter" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马" data-via="xxxx" data-hashtags="arthas"><i class="fab fa-twitter fa-fw"></i></a><a href="#" title="分享到 Facebook" data-sharer="facebook" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-hashtag="arthas"><i class="fab fa-facebook-square fa-fw"></i></a><a href="#" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="#" title="分享到 Line" data-sharer="line" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="#" title="分享到 微博" data-sharer="weibo" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马"><i class="fab fa-weibo fa-fw"></i></a><a href="#" title="分享到 Myspace" data-sharer="myspace" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="#" title="分享到 Blogger" data-sharer="blogger" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="#" title="分享到 Evernote" data-sharer="evernote" data-url="http://yanghx.vip/arthas-%E9%BB%91%E9%A9%AC/" data-title="arthas-黑马"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/arthas/">arthas</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/k8s-%E9%BB%91%E9%A9%AC/" class="prev" rel="prev" title="k8s基础-黑马"><i class="fas fa-angle-left fa-fw"></i>k8s基础-黑马</a></div>
</div>
<div id="comments"></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.111.3">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.3.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">yanghx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a  target="_blank" href="https://beian.miit.gov.cn/">京ICP备2023005717号-1</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="回到顶部">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div id="cookieconsent-container"></div><div class="assets"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>