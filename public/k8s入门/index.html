<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title> - yanghx blog</title><meta name="Description" content="yanghx blog"><meta property="og:title" content="" />
<meta property="og:description" content="k8s 介绍 阳明的ks8进阶手册 https://www.qikqiak.com/k8s-book k8s学习笔记 https://www.huweihuang.com/kubernetes-notes 安装 脚本部署用的脚本部署方式，具体看https://github.com/lework/kain" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" /><meta property="og:image" content="http://yanghx.vip/logo.png"/><meta property="article:section" content="posts" />

<meta property="og:site_name" content="yanghx blog" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://yanghx.vip/logo.png"/>

<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="k8s 介绍 阳明的ks8进阶手册 https://www.qikqiak.com/k8s-book k8s学习笔记 https://www.huweihuang.com/kubernetes-notes 安装 脚本部署用的脚本部署方式，具体看https://github.com/lework/kain"/>
<meta name="application-name" content="DoIt">
<meta name="apple-mobile-web-app-title" content="DoIt">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" /><link rel="prev" href="http://yanghx.vip/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3k8s%E7%BD%91%E7%BB%9C/" /><link rel="next" href="http://yanghx.vip/tomcat%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/yanghx.vip\/k8s%E5%85%A5%E9%97%A8\/"
        },"genre": "posts","wordcount":  6192 ,
        "url": "http:\/\/yanghx.vip\/k8s%E5%85%A5%E9%97%A8\/","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "yanghx"
            },"description": ""
    }
    </script><script src="//instant.page/5.1.1" defer type="module" integrity="sha384-MWfCL6g1OTGsbSwfuMHc8+8J2u71/LA8dzlIN3ycajckxuZZmF+DNjdm7O6H3PSq"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');}
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="yanghx blog">yanghx blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" class="menu-item theme-select" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="切换主题">
                        <option value="light">浅色</option>
                        <option value="dark">深色</option>
                        <option value="black">黑色</option>
                        <option value="auto">跟随系统</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="yanghx blog">yanghx blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="#" class="menu-item theme-select" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="切换主题">
                    <option value="light">浅色</option>
                    <option value="dark">深色</option>
                    <option value="black">黑色</option>
                    <option value="auto">跟随系统</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle", "normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "false")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX"></h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><i class="author fas fa-user-circle fa-fw"></i><a href="/" title="Author" rel=" author" class="author">yanghx</a>
                </span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="0001-01-01">0001-01-01</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="0001-01-01">0001-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 6192 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 13 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="true">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#安装">安装</a>
      <ul>
        <li><a href="#脚本部署">脚本部署</a></li>
      </ul>
    </li>
    <li><a href="#常用命令">常用命令</a>
      <ul>
        <li><a href="#kubeadm的常用命令"><code>kubeadm</code>的常用命令</a></li>
        <li><a href="#kubectl的常用命令"><code>kubectl</code>的常用命令</a></li>
      </ul>
    </li>
    <li><a href="#k8s架构">k8s架构</a></li>
    <li><a href="#k8s对象">k8s对象</a>
      <ul>
        <li><a href="#一-master">一<code> Master</code></a>
          <ul>
            <li><a href="#master的组件"><code>master</code>的组件</a></li>
          </ul>
        </li>
        <li><a href="#二-node">二 <code>NODE</code></a>
          <ul>
            <li><a href="#1-node-的组件">1 NODE 的组件</a></li>
            <li><a href="#2-node-的相关命令">2 NODE 的相关命令</a></li>
            <li><a href="#3-describe-命令的-node-信息">3 describe 命令的 Node 信息</a></li>
          </ul>
        </li>
        <li><a href="#三-pod">三 POD</a></li>
        <li><a href="#四-label">四 Label</a></li>
        <li><a href="#五---rc">五   <code>RC</code></a></li>
        <li><a href="#六-deployment">六 <code>Deployment</code></a></li>
        <li><a href="#七-hap-">七 <code>HAP </code></a></li>
        <li><a href="#八-service服务">八 <code>Service(服务)</code></a>
          <ul>
            <li><a href="#1-概述">1 概述</a></li>
            <li><a href="#2-k8s-的服务发现机制">2 k8s 的服务发现机制</a></li>
            <li><a href="#3-外部系统访问-service-的问题">3 外部系统访问 Service 的问题</a>
              <ul>
                <li><a href="#31-node-ip">3.1 <code>NODE IP</code></a></li>
                <li><a href="#32-pod-ip">3.2 <code>POD IP</code></a></li>
                <li><a href="#33-cluster-ip">3.3 <code>Cluster IP</code></a></li>
                <li><a href="#34-外部访问kubernetes集群">3.4 外部访问kubernetes集群</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#九-volume-存储卷">九 <code>Volume (存储卷)</code></a>
          <ul>
            <li><a href="#1-volume-的功能">1 Volume 的功能</a></li>
            <li><a href="#2-volume-的特点">2 Volume 的特点</a></li>
            <li><a href="#3-volume-的使用方式">3 Volume 的使用方式</a></li>
            <li><a href="#4-volume-类型">4 Volume 类型</a>
              <ul>
                <li><a href="#41-emptydir">4.1 <code>emptyDir</code></a></li>
                <li><a href="#42-hostpath">4.2 <code>hostPath</code></a></li>
                <li><a href="#43-gcepersistentdisk">4.3 <code>gcePersistentDisk</code></a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#十-persistent-volume">十 <code>Persistent Volume</code></a></li>
        <li><a href="#十一-namespace">十一 <code>Namespace</code></a></li>
        <li><a href="#十二-annotation-注解">十二 <code>Annotation (注解)</code></a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="k8s-介绍" class="headerLink">
    <a href="#k8s-%e4%bb%8b%e7%bb%8d" class="header-mark"></a><code>k8s</code> 介绍</h1><blockquote>
<p>阳明的ks8进阶手册 <code>https://www.qikqiak.com/k8s-book</code></p>
<p>k8s学习笔记 <code>https://www.huweihuang.com/kubernetes-notes</code></p>
</blockquote>
<h2 id="安装" class="headerLink">
    <a href="#%e5%ae%89%e8%a3%85" class="header-mark"></a>安装</h2><h3 id="脚本部署" class="headerLink">
    <a href="#%e8%84%9a%e6%9c%ac%e9%83%a8%e7%bd%b2" class="header-mark"></a>脚本部署</h3><p>用的脚本部署方式，具体看<code>https://github.com/lework/kainstall</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">wget https://ghproxy.com/https://raw.githubusercontent.com/lework/kainstall/master/kainstall-centos.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 本地安装 1.20.6 </span>
</span></span><span class="line"><span class="cl">bash kainstall-centos.sh init <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --master 192.168.0.110 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --worker 192.168.0.112 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --user root <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --password <span class="m">123456</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --port <span class="m">22</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --version 1.20.6 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --10years <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --offline-file 1.20.6_centos7.tgz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 本地安装 1.22.10</span>
</span></span><span class="line"><span class="cl">bash kainstall-centos.sh init <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --master 192.168.128.111 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --worker 192.168.128.115 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --user root <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --password <span class="m">123456</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --port <span class="m">22</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --version 1.22.10 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --10years <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --offline-file 1.22.10_centos7.tgz
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>问题</strong></p>
<ul>
<li>kubeadm init  失败 -&gt; <code>https://www.cnblogs.com/chalon/p/14840216.html</code></li>
</ul>
<p><strong>完全卸载k8s</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubeadm reset -f
</span></span><span class="line"><span class="cl">modprobe -r ipip
</span></span><span class="line"><span class="cl">lsmod
</span></span><span class="line"><span class="cl">rm -rf ~/.kube/
</span></span><span class="line"><span class="cl">rm -rf /etc/kubernetes/
</span></span><span class="line"><span class="cl">rm -rf /etc/systemd/system/kubelet.service.d
</span></span><span class="line"><span class="cl">rm -rf /etc/systemd/system/kubelet.service
</span></span><span class="line"><span class="cl">rm -rf /usr/bin/kube*
</span></span><span class="line"><span class="cl">rm -rf /etc/cni
</span></span><span class="line"><span class="cl">rm -rf /opt/cni
</span></span><span class="line"><span class="cl">rm -rf /var/lib/etcd
</span></span><span class="line"><span class="cl">rm -rf /var/etcd
</span></span><span class="line"><span class="cl">yum clean all
</span></span><span class="line"><span class="cl">yum remove kube* -f y
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="常用命令" class="headerLink">
    <a href="#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" class="header-mark"></a>常用命令</h2><ul>
<li><code>kubeadm</code>: 用来安装k8s的脚本</li>
<li><code>kubectl</code>: k8s的管理命令</li>
</ul>
<h3 id="kubeadm的常用命令" class="headerLink">
    <a href="#kubeadm%e7%9a%84%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" class="header-mark"></a><code>kubeadm</code>的常用命令</h3><h3 id="kubectl的常用命令" class="headerLink">
    <a href="#kubectl%e7%9a%84%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" class="header-mark"></a><code>kubectl</code>的常用命令</h3><blockquote>
<p>详细 <a href="https://www.huweihuang.com/kubernetes-notes/operation/kubectl/kubectl-commands.html" target="_blank" rel="noopener noreferrer">https://www.huweihuang.com/kubernetes-notes/operation/kubectl/kubectl-commands.html</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl <span class="o">[</span>command<span class="o">]</span> <span class="o">[</span>TYPE<span class="o">]</span> <span class="o">[</span>NAME<span class="o">]</span> <span class="o">[</span>flags<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><code>command</code>:  指定要在一个或多个资源进行操作，例如<code>create</code>，<code>get</code>，<code>describe</code>，<code>delete</code>。</p>
</li>
<li>
<p><code>TYPE</code>:  指定<a href="https://kubernetes.io/cn/docs/user-guide/kubectl-overview/#%e8%b5%84%e6%ba%90%e7%b1%bb%e5%9e%8b" target="_blank" rel="noopener noreferrer">资源类型</a>。资源类型区分大小写，您可以指定单数，复数或缩写形式.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 以下命令产生相同的输出：</span>
</span></span><span class="line"><span class="cl">kubectl get pod pod1  
</span></span><span class="line"><span class="cl">kubectl get pods pod1 
</span></span><span class="line"><span class="cl">kubectl get po pod1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get的常用方式</span>
</span></span><span class="line"><span class="cl">kubectl get pods  
</span></span><span class="line"><span class="cl">kubectl get deployments
</span></span><span class="line"><span class="cl">kubectl get rc  <span class="c1"># resource controller</span>
</span></span><span class="line"><span class="cl">kubectl get rs  <span class="c1"># resource set </span>
</span></span><span class="line"><span class="cl">kubectl get service
</span></span><span class="line"><span class="cl">kubectl get ingress
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>NAME</code>: 指定资源的名称。名称区分大小写。如果省略名称，则会显示所有资源的详细信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get pods  <span class="c1"># 省略命令，查看全部pod </span>
</span></span><span class="line"><span class="cl">kubectl get pods  ingress-demo-app-6c88bddcf8-725nk <span class="c1"># 查看指定pod </span>
</span></span><span class="line"><span class="cl">kubectl get pods  ingress-demo-app-6c88bddcf8-725nk, xxxx , xxx <span class="c1"># 查看多个pod</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* 要分组资源，如果它们都是相同的类型：<span class="sb">`</span>TYPE1 name1 name2 name&lt;<span class="c1">#&gt;`.&lt;br/&gt;</span>
</span></span><span class="line"><span class="cl">例: <span class="sb">`</span>$ kubectl get pod example-pod1 example-pod2<span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* 要分别指定多种资源类型:  <span class="sb">`</span>TYPE1/name1 TYPE1/name2 TYPE2/name3 TYPE&lt;<span class="c1">#&gt;/name&lt;#&gt;`.&lt;br/&gt;</span>
</span></span><span class="line"><span class="cl">例: <span class="sb">`</span>$ kubectl get pod/example-pod1 replicationcontroller/example-rc1<span class="sb">`</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>flags</code>: 指定可选标志。例如，您可以使用<code>-s</code>或<code>--serverflags</code>来指定Kubernetes API服务器的地址和端口。</p>
</li>
</ul>
<h2 id="k8s架构" class="headerLink">
    <a href="#k8s%e6%9e%b6%e6%9e%84" class="header-mark"></a>k8s架构</h2><h2 id="k8s对象" class="headerLink">
    <a href="#k8s%e5%af%b9%e8%b1%a1" class="header-mark"></a>k8s对象</h2><h3 id="一-master" class="headerLink">
    <a href="#%e4%b8%80-master" class="header-mark"></a>一<code> Master</code></h3><p>集群的控制节点，负责整个集群的管理和控制，kubernetes 的所有的命令基本都是发给 master 的，由它来负责具体执行流程。</p>
<h4 id="master的组件" class="headerLink">
    <a href="#master%e7%9a%84%e7%bb%84%e4%bb%b6" class="header-mark"></a><code>master</code>的组件</h4><ul>
<li><code>kube-apiserver</code>: 资源增删改查的入口</li>
<li><code>kube-controller-manager</code>: 资源对象的大总管</li>
<li><code>kube-scheduler</code>: 负责资源调度（Pod 调度）</li>
<li><code>etcd Server</code>: kubernetes 的所有的资源对象的数据保存在etcd中</li>
</ul>
<h3 id="二-node" class="headerLink">
    <a href="#%e4%ba%8c-node" class="header-mark"></a>二 <code>NODE</code></h3><p>Node 是集群的工作负载节点，默认情况 kubelet 会向 Master 注册自己，一但 Node 被纳入集群管理范围。</p>
<p>kubelet 会定时向 Master 汇报自身的情报，包括操作系统、Docker版本、机器资源情况等。</p>
<p>如果 Node 超过指定时间不上报信息，会被 Master 判断为 失联，标记为 Not Ready , 随后 Master 会触发 Pod 转移。</p>
<h4 id="1-node-的组件" class="headerLink">
    <a href="#1-node-%e7%9a%84%e7%bb%84%e4%bb%b6" class="header-mark"></a>1 NODE 的组件</h4><ul>
<li><code>kubelet</code>: Pod 的管家，与 Master 通信</li>
<li><code>kube-proxy</code>: 实现 kubernetes Service 的通信与负载均衡机制的重要组件</li>
<li><code>docker</code>: 容器的创建和管理</li>
</ul>
<h4 id="2-node-的相关命令" class="headerLink">
    <a href="#2-node-%e7%9a%84%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4" class="header-mark"></a>2 NODE 的相关命令</h4><ul>
<li><code>kubectl get nodes </code></li>
<li><code>kubeclt describe node {node_name}</code></li>
</ul>
<h4 id="3-describe-命令的-node-信息" class="headerLink">
    <a href="#3-describe-%e5%91%bd%e4%bb%a4%e7%9a%84-node-%e4%bf%a1%e6%81%af" class="header-mark"></a>3 describe 命令的 Node 信息</h4><ul>
<li>Node基本信息：名称、标签、创建时间等</li>
<li>Node当前的状态，Node启动后会进行自检工作，磁盘是否满，内存是否不足，若都正常则切换为Ready状态。</li>
<li>Node的主机地址与主机名</li>
<li>Node上的资源总量：CPU,内存，最大可调度Pod数量等</li>
<li>Node可分配资源量：当前Node可用于分配的资源量</li>
<li>主机系统信息：主机唯一标识符UUID，Linux kernel版本号，操作系统，kubernetes版本，kubelet与kube-proxy版本</li>
<li>当前正在运行的Pod列表及概要信息</li>
<li>已分配的资源使用概要，例如资源申请的最低、最大允许使用量占系统总量的百分比</li>
<li>Node相关的Event信息。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@k8s-master-node1 ~<span class="o">]</span><span class="c1"># kubectl  describe nodes k8s-master-node1</span>
</span></span><span class="line"><span class="cl">Name:               k8s-master-node1 <span class="c1"># 名称</span>
</span></span><span class="line"><span class="cl">Roles:              control-plane,master
</span></span><span class="line"><span class="cl">Labels:             beta.kubernetes.io/arch<span class="o">=</span>amd64 <span class="c1"># 标签</span>
</span></span><span class="line"><span class="cl">                    beta.kubernetes.io/os<span class="o">=</span>linux
</span></span><span class="line"><span class="cl">                    kubernetes.io/arch<span class="o">=</span>amd64
</span></span><span class="line"><span class="cl">                    kubernetes.io/hostname<span class="o">=</span>k8s-master-node1
</span></span><span class="line"><span class="cl">                    kubernetes.io/os<span class="o">=</span>linux
</span></span><span class="line"><span class="cl">                    node-role.kubernetes.io/control-plane<span class="o">=</span>
</span></span><span class="line"><span class="cl">                    node-role.kubernetes.io/master<span class="o">=</span>
</span></span><span class="line"><span class="cl">Annotations:        flannel.alpha.coreos.com/backend-data: <span class="o">{</span><span class="s2">&#34;VtepMAC&#34;</span>:<span class="s2">&#34;0a:f2:1a:ec:31:c5&#34;</span><span class="o">}</span>
</span></span><span class="line"><span class="cl">                    flannel.alpha.coreos.com/backend-type: vxlan
</span></span><span class="line"><span class="cl">                    flannel.alpha.coreos.com/kube-subnet-manager: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">                    flannel.alpha.coreos.com/public-ip: 192.168.128.124
</span></span><span class="line"><span class="cl">                    kubeadm.alpha.kubernetes.io/cri-socket: unix:///run/containerd/containerd.sock
</span></span><span class="line"><span class="cl">                    node.alpha.kubernetes.io/ttl: <span class="m">0</span>
</span></span><span class="line"><span class="cl">                    volumes.kubernetes.io/controller-managed-attach-detach: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">CreationTimestamp:  Wed, <span class="m">11</span> Jan <span class="m">2023</span> 09:34:42 +0800 <span class="c1"># 创建时间</span>
</span></span><span class="line"><span class="cl">Taints:             &lt;none&gt;
</span></span><span class="line"><span class="cl">Unschedulable:      <span class="nb">false</span>
</span></span><span class="line"><span class="cl">Lease:
</span></span><span class="line"><span class="cl">  HolderIdentity:  k8s-master-node1
</span></span><span class="line"><span class="cl">  AcquireTime:     &lt;unset&gt;
</span></span><span class="line"><span class="cl">  RenewTime:       Wed, <span class="m">11</span> Jan <span class="m">2023</span> 15:09:41 +0800
</span></span><span class="line"><span class="cl">Conditions:
</span></span><span class="line"><span class="cl">  Type                 Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
</span></span><span class="line"><span class="cl">  ----                 ------  -----------------                 ------------------                ------                       -------
</span></span><span class="line"><span class="cl">  NetworkUnavailable   False   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 14:08:54 +0800   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 14:08:54 +0800   FlannelIsUp                  Flannel is running on this node
</span></span><span class="line"><span class="cl">  MemoryPressure       False   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 15:09:47 +0800   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 09:34:42 +0800   KubeletHasSufficientMemory   kubelet has sufficient memory available
</span></span><span class="line"><span class="cl">  DiskPressure         False   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 15:09:47 +0800   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 09:34:42 +0800   KubeletHasNoDiskPressure     kubelet has no disk pressure
</span></span><span class="line"><span class="cl">  PIDPressure          False   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 15:09:47 +0800   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 09:34:42 +0800   KubeletHasSufficientPID      kubelet has sufficient PID available
</span></span><span class="line"><span class="cl">  Ready                True    Wed, <span class="m">11</span> Jan <span class="m">2023</span> 15:09:47 +0800   Wed, <span class="m">11</span> Jan <span class="m">2023</span> 09:35:27 +0800   KubeletReady                 kubelet is posting ready status
</span></span><span class="line"><span class="cl">Addresses: <span class="c1"># 主机地址 主机名</span>
</span></span><span class="line"><span class="cl">  InternalIP:  192.168.128.124 
</span></span><span class="line"><span class="cl">  Hostname:    k8s-master-node1
</span></span><span class="line"><span class="cl">Capacity: <span class="c1"># 资源信息  </span>
</span></span><span class="line"><span class="cl">  cpu:                <span class="m">2</span>
</span></span><span class="line"><span class="cl">  ephemeral-storage:  17394Mi
</span></span><span class="line"><span class="cl">  hugepages-1Gi:      <span class="m">0</span>
</span></span><span class="line"><span class="cl">  hugepages-2Mi:      <span class="m">0</span>
</span></span><span class="line"><span class="cl">  memory:             3861264Ki
</span></span><span class="line"><span class="cl">  pods:               <span class="m">200</span>
</span></span><span class="line"><span class="cl">Allocatable:
</span></span><span class="line"><span class="cl">  cpu:                1500m
</span></span><span class="line"><span class="cl">  ephemeral-storage:  <span class="m">14267554175</span>
</span></span><span class="line"><span class="cl">  hugepages-1Gi:      <span class="m">0</span>
</span></span><span class="line"><span class="cl">  hugepages-2Mi:      <span class="m">0</span>
</span></span><span class="line"><span class="cl">  memory:             2812688Ki
</span></span><span class="line"><span class="cl">  pods:               <span class="m">200</span>
</span></span><span class="line"><span class="cl">System Info:
</span></span><span class="line"><span class="cl">  Machine ID:                 d6d800db39f144a4887558a9f83ceea9
</span></span><span class="line"><span class="cl">  System UUID:                A6714D56-D99C-3872-4DE2-0D72C866ADC4
</span></span><span class="line"><span class="cl">  Boot ID:                    aa579834-1596-40df-96ea-5e41dbd5ee89
</span></span><span class="line"><span class="cl">  Kernel Version:             3.10.0-1160.71.1.el7.x86_64
</span></span><span class="line"><span class="cl">  OS Image:                   CentOS Linux <span class="m">7</span> <span class="o">(</span>Core<span class="o">)</span>
</span></span><span class="line"><span class="cl">  Operating System:           linux
</span></span><span class="line"><span class="cl">  Architecture:               amd64
</span></span><span class="line"><span class="cl">  Container Runtime Version:  containerd://1.6.15
</span></span><span class="line"><span class="cl">  Kubelet Version:            v1.20.6
</span></span><span class="line"><span class="cl">  Kube-Proxy Version:         v1.20.6
</span></span><span class="line"><span class="cl">PodCIDR:                      10.244.0.0/24
</span></span><span class="line"><span class="cl">PodCIDRs:                     10.244.0.0/24
</span></span><span class="line"><span class="cl">Non-terminated Pods:          <span class="o">(</span><span class="m">7</span> in total<span class="o">)</span>
</span></span><span class="line"><span class="cl">  Namespace                   Name                                        CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE
</span></span><span class="line"><span class="cl">  ---------                   ----                                        ------------  ----------  ---------------  -------------  ---
</span></span><span class="line"><span class="cl">  kube-system                 coredns-8496bbfb78-4w6vw                    100m <span class="o">(</span>6%<span class="o">)</span>     <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      70Mi <span class="o">(</span>2%<span class="o">)</span>        170Mi <span class="o">(</span>6%<span class="o">)</span>     5h34m
</span></span><span class="line"><span class="cl">  kube-system                 etcd-k8s-master-node1                       100m <span class="o">(</span>6%<span class="o">)</span>     <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      100Mi <span class="o">(</span>3%<span class="o">)</span>       <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>         5h34m
</span></span><span class="line"><span class="cl">  kube-system                 kube-apiserver-k8s-master-node1             250m <span class="o">(</span>16%<span class="o">)</span>    <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>           <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>         5h34m
</span></span><span class="line"><span class="cl">  kube-system                 kube-controller-manager-k8s-master-node1    200m <span class="o">(</span>13%<span class="o">)</span>    <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>           <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>         5h34m
</span></span><span class="line"><span class="cl">  kube-system                 kube-flannel-ds-d85pr                       100m <span class="o">(</span>6%<span class="o">)</span>     100m <span class="o">(</span>6%<span class="o">)</span>   50Mi <span class="o">(</span>1%<span class="o">)</span>        50Mi <span class="o">(</span>1%<span class="o">)</span>      5h34m
</span></span><span class="line"><span class="cl">  kube-system                 kube-proxy-8tslx                            <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>        <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>           <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>         5h34m
</span></span><span class="line"><span class="cl">  kube-system                 kube-scheduler-k8s-master-node1             100m <span class="o">(</span>6%<span class="o">)</span>     <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>           <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>         5h34m
</span></span><span class="line"><span class="cl">Allocated resources:
</span></span><span class="line"><span class="cl">  <span class="o">(</span>Total limits may be over <span class="m">100</span> percent, i.e., overcommitted.<span class="o">)</span>
</span></span><span class="line"><span class="cl">  Resource           Requests    Limits
</span></span><span class="line"><span class="cl">  --------           --------    ------
</span></span><span class="line"><span class="cl">  cpu                850m <span class="o">(</span>56%<span class="o">)</span>  100m <span class="o">(</span>6%<span class="o">)</span>
</span></span><span class="line"><span class="cl">  memory             220Mi <span class="o">(</span>8%<span class="o">)</span>  220Mi <span class="o">(</span>8%<span class="o">)</span>
</span></span><span class="line"><span class="cl">  ephemeral-storage  100Mi <span class="o">(</span>0%<span class="o">)</span>  <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>
</span></span><span class="line"><span class="cl">  hugepages-1Gi      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>
</span></span><span class="line"><span class="cl">  hugepages-2Mi      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>      <span class="m">0</span> <span class="o">(</span>0%<span class="o">)</span>
</span></span><span class="line"><span class="cl">Events:
</span></span><span class="line"><span class="cl">  Type     Reason                   Age                    From        Message
</span></span><span class="line"><span class="cl">  ----     ------                   ----                   ----        -------
</span></span><span class="line"><span class="cl">  Normal   NodeHasSufficientMemory  5h36m <span class="o">(</span>x5 over 5h36m<span class="o">)</span>  kubelet     Node k8s-master-node1 status is now: NodeHasSufficientMemory
</span></span><span class="line"><span class="cl">  Normal   NodeHasNoDiskPressure    5h36m <span class="o">(</span>x5 over 5h36m<span class="o">)</span>  kubelet     Node k8s-master-node1 status is now: NodeHasNoDiskPressure
</span></span><span class="line"><span class="cl">  Normal   NodeHasSufficientPID     5h36m <span class="o">(</span>x5 over 5h36m<span class="o">)</span>  kubelet     Node k8s-master-node1 status is now: NodeHasSufficientPID
</span></span><span class="line"><span class="cl">  Normal   Starting                 5h34m                  kubelet     Starting kubelet.
</span></span><span class="line"><span class="cl">  Warning  InvalidDiskCapacity      5h34m                  kubelet     invalid capacity <span class="m">0</span> on image filesystem
</span></span><span class="line"><span class="cl">  Normal   NodeAllocatableEnforced  5h34m                  kubelet     Updated Node Allocatable limit across pods
</span></span><span class="line"><span class="cl">  Normal   NodeHasSufficientMemory  5h34m                  kubelet     Node k8s-master-node1 status is now: NodeHasSufficientMemory
</span></span><span class="line"><span class="cl">  Normal   NodeHasNoDiskPressure    5h34m                  kubelet     Node k8s-master-node1 status is now: NodeHasNoDiskPressure
</span></span><span class="line"><span class="cl">  Normal   NodeHasSufficientPID     5h34m                  kubelet     Node k8s-master-node1 status is now: NodeHasSufficientPID
</span></span><span class="line"><span class="cl">  Normal   Starting                 5h34m                  kube-proxy  Starting kube-proxy.
</span></span><span class="line"><span class="cl">  Normal   NodeReady                5h34m                  kubelet     Node k8s-master-node1 status is now: NodeReady
</span></span><span class="line"><span class="cl">  Normal   Starting                 63m                    kubelet     Starting kubelet.
</span></span><span class="line"><span class="cl">  Warning  InvalidDiskCapacity      63m                    kubelet     invalid capacity <span class="m">0</span> on image filesystem
</span></span><span class="line"><span class="cl">  Normal   NodeHasSufficientMemory  63m <span class="o">(</span>x7 over 63m<span class="o">)</span>      kubelet     Node k8s-master-node1 status is now: NodeHasSufficientMemory
</span></span><span class="line"><span class="cl">  Normal   NodeHasSufficientPID     63m <span class="o">(</span>x7 over 63m<span class="o">)</span>      kubelet     Node k8s-master-node1 status is now: NodeHasSufficientPID
</span></span><span class="line"><span class="cl">  Normal   NodeAllocatableEnforced  63m                    kubelet     Updated Node Allocatable limit across pods
</span></span><span class="line"><span class="cl">  Normal   NodeHasNoDiskPressure    62m <span class="o">(</span>x8 over 63m<span class="o">)</span>      kubelet     Node k8s-master-node1 status is now: NodeHasNoDiskPressure
</span></span><span class="line"><span class="cl">  Normal   Starting                 61m                    kube-proxy  Starting kube-proxy.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="三-pod" class="headerLink">
    <a href="#%e4%b8%89-pod" class="header-mark"></a>三 POD</h3><p>Pod 是k8s中操作的基本单元。 每个Pod 都有一个根容器( Pause 容器 )，Pause 容器的状态代表整个容器组的状态，其他业务容器共享 Pause 的 IP, 即Pod IP, 共享 Pause 挂载的 Volume, 这样简化了同个Pod中不同容器之间的网络问题和文件共享问题。</p>
<p><a class="lightgallery" href="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png" title="pod" data-thumbnail="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png">
        <img
            
            loading="lazy"
            src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png"
            srcset="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png, https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png 1.5x, https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png 2x"
            sizes="auto"
            alt="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod.png">
    </a></p>
<ol>
<li>
<p>k8s集群中，同宿主机的或不同宿主机的 Pod 之间要求能够TCP/IP直接通信，因此采用虚拟二层网络技术来实现，例如 Flannel, Openvswitch( OVS ) 等，这样在同一个集群中不同的宿主机的 POD IP 为不同 IP段，集群中的所有 POD IP 都是唯一的，不同 POD 之间可以直接通信。</p>
</li>
<li>
<p>POD 有两种类型： 普通 POD 和 静态 POD 。 静态 POD 即不通过 K8S 调度和创建，直接在某个具体的 Node 机器上通过具体的文件来启动。 普通 POD 则是由 K8S 创建、调度，同时数据存放在 ETCD 中。</p>
</li>
<li>
<p>POD IP 和具体的容器端口 (ContainnerPort) 组成一个具体的通信地址，即 Endpoint 。 一个 POD 中可以存在多个容器，可以有多个端口，POD IP 一样，即有多个 Endpoint。</p>
</li>
<li>
<p>POD Volume 是定义在 POD 之上，被各个容器挂载自己的文件系统中，可以用<code>分布式文件系统</code>实现后端存储功能。</p>
</li>
<li>
<p>POD 中的 Event 事件可以用来排查问题，可以通过 <code>kubectl describe pod xxx </code> 来查看对应的事件。</p>
</li>
<li>
<p>每个 POD 可以对其能使用的服务器上的计算资源设置限额，一般为 CPU 和 Memory。 K8S 中一般将 千分之一个的 CPU 配置作为最小单元，用m表示，是一个绝对值，即100m对于一个core 的机器还是 48个 core 的机器都是一样的大小。 Memory 配额也是个绝对值，单位为内存字节数。</p>
</li>
<li>
<p>资源配额的两个参数。</p>
<ol>
<li>
<p><code>Requests</code> : 该资源的最小申请量，系统必须满足要求。</p>
</li>
<li>
<p><code>Limits</code>: 该资源最大允许使用量，当超过该量，k8s 会 kill 并重启POD</p>
</li>
</ol>
</li>
</ol>
<p><a class="lightgallery" href="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png" title="pod2" data-thumbnail="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png">
        <img
            
            loading="lazy"
            src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png"
            srcset="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png, https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png 1.5x, https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png 2x"
            sizes="auto"
            alt="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/pod2.png">
    </a></p>
<h3 id="四-label" class="headerLink">
    <a href="#%e5%9b%9b-label" class="header-mark"></a>四 Label</h3><ol>
<li>Label是一个键值对，可以附加在任何对象上，比如Node,Pod,Service,RC等。Label和资源对象是多对多的关系，即一个Label可以被添加到多个对象上，一个对象也可以定义多个Label。</li>
<li>Label的作用主要用来实现精细的、多维度的资源分组管理，以便进行资源分配，调度，配置，部署等工作。</li>
<li>Label通俗理解就是“标签”，通过标签来过滤筛选指定的对象，进行具体的操作。k8s通过Label Selector(标签选择器)来筛选指定Label的资源对象，类似SQL语句中的条件查询（WHERE语句）。</li>
<li>Label Selector有基于等式和基于集合的两种表达方式，可以多个条件进行组合使用。</li>
<li>基于等式：name=redis-slave（匹配name=redis-slave的资源对象）;env!=product(匹配所有不具有标签env=product的资源对象)</li>
<li>基于集合：name in (redis-slave,redis-master);name not in (php-frontend)（匹配所有不具有标签name=php-frontend的资源对象）</li>
</ol>
<p><strong>使用场景</strong></p>
<ol>
<li>kube-controller进程通过资源对象RC上定义的Label Selector来筛选要监控的Pod副本数，从而实现副本数始终保持预期数目。</li>
<li>kube-proxy进程通过Service的Label Selector来选择对应Pod，自动建立每个Service到对应Pod的请求转发路由表，从而实现Service的智能负载均衡机制。</li>
<li>kube-scheduler实现Pod定向调度：对Node定义特定的Label，并且在Pod定义文件中使用NodeSelector标签调度策略。</li>
</ol>
<h3 id="五---rc" class="headerLink">
    <a href="#%e4%ba%94---rc" class="header-mark"></a>五   <code>RC</code></h3><p>RC (Replication Controller) 是K8S 系统中的核心概念，定义了一个期望的场景。</p>
<p>主要包括</p>
<ul>
<li>POD 期望的副本数 <code>replicas</code></li>
<li>用于筛选目标 POD 的 <code>Label Selector</code></li>
<li>用于创建 POD 的模板 <code>template</code></li>
</ul>
<p>RC 特性说明 :</p>
<ol>
<li>POD 的缩放可以通过以下命令实现  <code>kubectl scale rc redis-slave --replicas=3 </code></li>
<li>删除 RC 并不会删除该 RC 创建的 POD , 可以将副本数设置为0，即可删除对应 POD 。 或者通过 <code>kubectl stop / delete</code> 命令来一次性删除 RC 和其创建的 POD。</li>
<li>改变 RC 中 POD 模板的镜像版本可以实现滚动升级 (<code>Rolling Update </code>) 具体操作见<code>https://kubernetes.io/docs/tasks/run-application/rolling-update-replication-controller</code></li>
<li>kubernetes1.2 以上版本将 RC 升级为 <code>Replica Set </code>, 它与当前 RC 的唯一区别在于 <code>Replica SET</code> 支持基于集合的 <code>Label Selector (Set-based selector)</code>, 而旧版本 RC 只支持基于等式的<code> Label Selector (equality-based selector)</code>。</li>
<li>kubernetes1.2 以上版本通过 <code>Deployment</code> 来维护 <code>Replica Set </code> 而不是单独使用 <code>Replica Set</code>。 即控制流为 <code>Deployment -&gt; Replica Set -&gt; POD</code>。 即新版本的 <code>Deployment + Replica Set</code> 替代了 RC 的作用。</li>
</ol>
<h3 id="六-deployment" class="headerLink">
    <a href="#%e5%85%ad-deployment" class="header-mark"></a>六 <code>Deployment</code></h3><p>Deployment 是 kubernetes 1.2 引入的概念， 用来解决 POD 的编排问题。 Deployment 可以理解为 RC 的 升级版 <code>RC + Replica Set</code> 。 特点在于可以随时知道 POD 的部署进度，即对 POD 的创建、调度、绑定节点、启动容器完整过程的进度展示。</p>
<p><strong>使用场景</strong></p>
<ol>
<li>创建一个 Deployment 对象来生成对应的 Replica Set 并完成 POD 副本的创建过程。</li>
<li>检查 Deployment 的状态来确认部署动作是否完成 （POD 副本的数量是否达到预期值）</li>
<li>更新 Deployment 以创建新的 POD (例如镜像升级的场景)</li>
<li>如果当前 Deployment 不稳定，回退到上一个 Deployment 版本。</li>
<li>挂起或恢复一个 Deployment。</li>
</ol>
<p>可以通过 <code>kubectl describe deployment </code> 来查看 Deployment 控制的 POD的水平扩展过程。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>root@k8s-master-node1 ~<span class="o">]</span><span class="c1"># kubectl describe deployment</span>
</span></span><span class="line"><span class="cl">Name:                   ingress-demo-app
</span></span><span class="line"><span class="cl">Namespace:              default
</span></span><span class="line"><span class="cl">CreationTimestamp:      Wed, <span class="m">11</span> Jan <span class="m">2023</span> 09:35:45 +0800
</span></span><span class="line"><span class="cl">Labels:                 <span class="nv">app</span><span class="o">=</span>ingress-demo-app
</span></span><span class="line"><span class="cl">Annotations:            deployment.kubernetes.io/revision: <span class="m">1</span>
</span></span><span class="line"><span class="cl">Selector:               <span class="nv">app</span><span class="o">=</span>ingress-demo-app
</span></span><span class="line"><span class="cl">Replicas:               <span class="m">2</span> desired <span class="p">|</span> <span class="m">2</span> updated <span class="p">|</span> <span class="m">2</span> total <span class="p">|</span> <span class="m">2</span> available <span class="p">|</span> <span class="m">0</span> unavailable
</span></span><span class="line"><span class="cl">StrategyType:           RollingUpdate
</span></span><span class="line"><span class="cl">MinReadySeconds:        <span class="m">0</span>
</span></span><span class="line"><span class="cl">RollingUpdateStrategy:  25% max unavailable, 25% max surge
</span></span><span class="line"><span class="cl">Pod Template:
</span></span><span class="line"><span class="cl">  Labels:  <span class="nv">app</span><span class="o">=</span>ingress-demo-app
</span></span><span class="line"><span class="cl">  Containers:
</span></span><span class="line"><span class="cl">   whoami:
</span></span><span class="line"><span class="cl">    Image:        traefik/whoami:v1.7.1
</span></span><span class="line"><span class="cl">    Port:         80/TCP
</span></span><span class="line"><span class="cl">    Host Port:    0/TCP
</span></span><span class="line"><span class="cl">    Environment:  &lt;none&gt;
</span></span><span class="line"><span class="cl">    Mounts:       &lt;none&gt;
</span></span><span class="line"><span class="cl">  Volumes:        &lt;none&gt;
</span></span><span class="line"><span class="cl">Conditions:
</span></span><span class="line"><span class="cl">  Type           Status  Reason
</span></span><span class="line"><span class="cl">  ----           ------  ------
</span></span><span class="line"><span class="cl">  Progressing    True    NewReplicaSetAvailable
</span></span><span class="line"><span class="cl">  Available      True    MinimumReplicasAvailable
</span></span><span class="line"><span class="cl">OldReplicaSets:  &lt;none&gt;
</span></span><span class="line"><span class="cl">NewReplicaSet:   ingress-demo-app-6c88bddcf8 <span class="o">(</span>2/2 replicas created<span class="o">)</span>
</span></span><span class="line"><span class="cl">Events:
</span></span><span class="line"><span class="cl">  Type    Reason             Age    From                   Message
</span></span><span class="line"><span class="cl">  ----    ------             ----   ----                   -------
</span></span><span class="line"><span class="cl">  Normal  ScalingReplicaSet  6h35m  deployment-controller  Scaled up replica <span class="nb">set</span> ingress-demo-app-6c88bddcf8 to <span class="m">2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="七-hap-" class="headerLink">
    <a href="#%e4%b8%83-hap-" class="header-mark"></a>七 <code>HAP </code></h3><blockquote>
<p>Horizontal Pod Autoscaler(HPA)即Pod横向自动扩容，与RC一样也属于k8s的资源对象。</p>
</blockquote>
<p>HPA原理：通过追踪分析RC控制的所有目标Pod的负载变化情况，来确定是否针对性调整Pod的副本数。</p>
<p>POD 负载度量指标：</p>
<ul>
<li><code>CPUUtilizationPercentage</code>: POD 所有副本自身的 CPU 利用率的平均值。 即当前 POD 的 CPU 使用量除以 POD Request 的值。</li>
<li>应用自定义的度量指标，比如服务每秒内响应的请求数 （TPS/QPS）。</li>
</ul>
<h3 id="八-service服务" class="headerLink">
    <a href="#%e5%85%ab-service%e6%9c%8d%e5%8a%a1" class="header-mark"></a>八 <code>Service(服务)</code></h3><h4 id="1-概述" class="headerLink">
    <a href="#1-%e6%a6%82%e8%bf%b0" class="header-mark"></a>1 概述</h4><p><a class="lightgallery" href="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png" title="service" data-thumbnail="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png">
        <img
            
            loading="lazy"
            src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png"
            srcset="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png, https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png 1.5x, https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png 2x"
            sizes="auto"
            alt="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510578930/article/kubernetes/concept/service.png">
    </a></p>
<p>Service 定义了一个服务的访问入口地址，前端应用通过这个入口地址访问其背后的一组由 POD 副本组成的集群实例，Service 与其后端 POD 副本集群之间是通过 <code>Label Selector </code> 来实现 无缝对接。 RC 保证 Service 的 POD 副本实例数目保持预期水平。</p>
<h4 id="2-k8s-的服务发现机制" class="headerLink">
    <a href="#2-k8s-%e7%9a%84%e6%9c%8d%e5%8a%a1%e5%8f%91%e7%8e%b0%e6%9c%ba%e5%88%b6" class="header-mark"></a>2 k8s 的服务发现机制</h4><p>主要通过<code>kube-dns</code> 这个组件来进行DNS方式的服务发现。</p>
<h4 id="3-外部系统访问-service-的问题" class="headerLink">
    <a href="#3-%e5%a4%96%e9%83%a8%e7%b3%bb%e7%bb%9f%e8%ae%bf%e9%97%ae-service-%e7%9a%84%e9%97%ae%e9%a2%98" class="header-mark"></a>3 外部系统访问 Service 的问题</h4><table>
<thead>
<tr>
<th>IP类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Node IP</td>
<td>Node节点的IP地址</td>
</tr>
<tr>
<td>Pod IP</td>
<td>Pod的IP地址</td>
</tr>
<tr>
<td>Cluster IP</td>
<td>Service的IP地址</td>
</tr>
</tbody>
</table>
<h5 id="31-node-ip" class="headerLink">
    <a href="#31-node-ip" class="header-mark"></a>3.1 <code>NODE IP</code></h5><p>Node IP 是集群中每个节点的物理网卡 IP 地址，是真实存在的物理网络，kubernetes 集群之外的节点访问 kubernetes 内的某个节点或 TCP/IP 服务的时候，需要通过 NODE IP 进行通信。</p>
<h5 id="32-pod-ip" class="headerLink">
    <a href="#32-pod-ip" class="header-mark"></a>3.2 <code>POD IP</code></h5><p>POD IP 是每个 POD 的 IP 地址，是 Docker Engine 根据 docker0 网桥的 IP 段地址进行分配的，是一个虚拟的二层网络，集群中一个 POD 的容器访问另一个 POD 中的容器，是通过 POD IP 进行通信的，而真实的 TCP/IP 流量是通过 <code>NODE IP</code>所在的网卡流出的。</p>
<h5 id="33-cluster-ip" class="headerLink">
    <a href="#33-cluster-ip" class="header-mark"></a>3.3 <code>Cluster IP</code></h5><ol>
<li>Service 的 Cluster IP 是一个虚拟 IP , 只作用于 Service 这个对象，由kubernetes 管理和分配 IP 地址。(来源于 Cluster IP 地址池)</li>
<li>Cluster IP 无法被 ping  通，因为没有一个实体网络对象来响应。</li>
<li>Cluster IP 结合 Service Port 组成的具体通信端口才具备 TCP/IP 通信基础，属于kubernetes 集群内，集群外访问该IP和端口需要额外处理。</li>
<li>k8s 集群内Node IP、 Pod IP 、 Cluster IP 之间的通信采取 k8s 自己特殊的路由规则，与传统IP路由不同。</li>
</ol>
<h5 id="34-外部访问kubernetes集群" class="headerLink">
    <a href="#34-%e5%a4%96%e9%83%a8%e8%ae%bf%e9%97%aekubernetes%e9%9b%86%e7%be%a4" class="header-mark"></a>3.4 外部访问kubernetes集群</h5><p>通过宿主机与容器端口映射的方式进行访问，例如： Service 定位文件如下：<code>(原文就没有图)</code></p>
<p>可以通过任意Node的IP 加端口访问该服务。也可以通过 Nginx 或 HaProxy 来设置负载均衡。</p>
<h3 id="九-volume-存储卷" class="headerLink">
    <a href="#%e4%b9%9d-volume-%e5%ad%98%e5%82%a8%e5%8d%b7" class="header-mark"></a>九 <code>Volume (存储卷)</code></h3><h4 id="1-volume-的功能" class="headerLink">
    <a href="#1-volume-%e7%9a%84%e5%8a%9f%e8%83%bd" class="header-mark"></a>1 Volume 的功能</h4><ol>
<li>Volume 是 POD 中能够被多个容器访问的共享目录，可以让容器的数据写到宿主机上或者写文件到网络存储中。</li>
<li>可以实现容器配置文件集中化定义与管理，通过ConfigMap 资源对象来实现。</li>
</ol>
<h4 id="2-volume-的特点" class="headerLink">
    <a href="#2-volume-%e7%9a%84%e7%89%b9%e7%82%b9" class="header-mark"></a>2 Volume 的特点</h4><p>k8s中的 Volume 与 Docker 的 Volume 相似，但不完成相同。</p>
<ol>
<li>k8s 上 Volume 定义在 POD 上，然后被一个 POD 中的多个容器挂载到具体的文件目录下。</li>
<li>k8s 的 Volume 与 POD 生命周期相关而不是容器的生命周期， 即容器挂掉，数据不会丢失但是 POD 挂掉,数据则会丢失。</li>
<li>k8s 中的 Volume 支持多种类型 Volume : Ceph、 GlusterFS 等分布式系统。</li>
</ol>
<h4 id="3-volume-的使用方式" class="headerLink">
    <a href="#3-volume-%e7%9a%84%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f" class="header-mark"></a>3 Volume 的使用方式</h4><p>先在 POD 声明一个 Volume, 然后容器引用该 Volume 并 Mount 到容器的某个目录。</p>
<h4 id="4-volume-类型" class="headerLink">
    <a href="#4-volume-%e7%b1%bb%e5%9e%8b" class="header-mark"></a>4 Volume 类型</h4><h5 id="41-emptydir" class="headerLink">
    <a href="#41-emptydir" class="header-mark"></a>4.1 <code>emptyDir</code></h5><p><code>emptyDri Volume</code> 是在 POD 分配到 NODE 是创建的，初始内容为空，无需指定宿主机上对应的目录文件，由 K8S 自动分配一个目录，当 POD 被删除时，对应的 emptyDir 数据也会永久删除。</p>
<p><em><strong>作用：</strong></em></p>
<ol>
<li>临时文件，例如程序的临时文件，无需永久保留。</li>
<li>长时间任务的中间过程 CheckPoint 的临时保存目录。</li>
<li>一个容器需要从另一个容器中获取数据的目录 ( 即多容器共享目录 )</li>
</ol>
<h5 id="42-hostpath" class="headerLink">
    <a href="#42-hostpath" class="header-mark"></a>4.2 <code>hostPath</code></h5><p>hostPath 是在 POD 上挂载宿主机上的文件或目录。</p>
<p><em><strong>作用</strong></em></p>
<ol>
<li>容器应用日志需要持久化时，可以使用宿主机的高速文件系统进行存储</li>
<li>需要访问宿主机上Docker引擎内部数据结构的容器应用时，可以通过定义hostPath为宿主机/var/lib/docker目录，使容器内部应用可以直接访问Docker的文件系统。</li>
</ol>
<p><strong>注意点：</strong></p>
<ol>
<li>在不同的Node上具有相同配置的Pod可能会因为宿主机上的目录或文件不同导致对Volume上目录或文件的访问结果不一致。</li>
<li>如果使用了资源配额管理，则kubernetes无法将hostPath在宿主机上使用的资源纳入管理。</li>
</ol>
<h5 id="43-gcepersistentdisk" class="headerLink">
    <a href="#43-gcepersistentdisk" class="header-mark"></a>4.3 <code>gcePersistentDisk</code></h5><p>表示使用谷歌公有云提供的永久磁盘（Persistent Disk ,PD）存放Volume的数据，它与EmptyDir不同，PD上的内容会被永久保存。当Pod被删除时，PD只是被卸载时，但不会被删除。需要先创建一个永久磁盘，才能使用gcePersistentDisk。</p>
<p>使用gcePersistentDisk的限制条件：</p>
<ul>
<li>Node(运行kubelet的节点)需要是GCE虚拟机。</li>
<li>虚拟机需要与PD存在于相同的GCE项目中和Zone中。</li>
</ul>
<h3 id="十-persistent-volume" class="headerLink">
    <a href="#%e5%8d%81-persistent-volume" class="header-mark"></a>十 <code>Persistent Volume</code></h3><p>Volume 定义在 POD 上，属于“计算资源” 的一部分， 而 <code>Persistent Volume</code> 和 <code>Persistent Volume Claim</code>是网络存储，简称 PV 和 PVC , 可以理解为 k8s 集群中某个网络存储中对应的一块存储。</p>
<ul>
<li>PV 是网络存储，不属于任何 Node,但可以在每个 Node 上访问。</li>
<li>PV 不是定义在Pod上, 而是独立于 Pod 之外定义。</li>
<li>PV 常见类型： <code>GCE Persistent Disks  、 NFS 、 RBD </code>等。</li>
</ul>
<p>PV 是有状态的对象，状态类型如下：</p>
<ul>
<li><code>Available</code>: 空闲状态。</li>
<li><code>Bound</code>: 已经绑定到某个PVC上。</li>
<li><code>Released</code>: 对应的 PVC 已经删除，但资源还没有回收。</li>
<li><code>Failed</code>: PV自动回收失败。</li>
</ul>
<h3 id="十一-namespace" class="headerLink">
    <a href="#%e5%8d%81%e4%b8%80-namespace" class="header-mark"></a>十一 <code>Namespace</code></h3><p>namespace 即命名空间，主要用于多租户的资源隔离，通过将资源对象分配到不同的 namespace 上，便于不同的分组在共享资源的同时可以被分别管理。</p>
<p>k8s 集群启动后会默认创建一个 <code>default</code>的 namespace。 可以通过 <code>kubectl get namespaces</code>查看。</p>
<p>可以通过 <code>kubectl config use-context namespace</code> 配置当前 k8s 客户端的环境，通过 <code>kubectl get pods </code> 获取当前 namespace 的 POD 。 或者通过 <code>kubectl get pods --namespace = {namespace}</code>来获取指定 namespace 的 POD 。</p>
<h3 id="十二-annotation-注解" class="headerLink">
    <a href="#%e5%8d%81%e4%ba%8c-annotation-%e6%b3%a8%e8%a7%a3" class="header-mark"></a>十二 <code>Annotation (注解)</code></h3><p>Annotation 与 Label 类似，也使用 key/value 的形式进行定义，Label定义元数据 <code>Matadata</code>, Annotation 定义“附加”信息。</p>
<p>通常 Annotation 记录信息如下：</p>
<ul>
<li>build 信息，release 信息， Docker 镜像信息等。</li>
<li>日志库，监控库等。</li>
</ul>
</div>

        

<div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 0001-01-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/k8s%E5%85%A5%E9%97%A8/index.md target="_blank" rel="noopener noreferrer">阅读原始文档</a>
                    </span></div>
            <div class="post-info-share">
                <span><a href="#" title="分享到 Twitter" data-sharer="twitter" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title="" data-via="xxxx"><i class="fab fa-twitter fa-fw"></i></a><a href="#" title="分享到 Facebook" data-sharer="facebook" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/"><i class="fab fa-facebook-square fa-fw"></i></a><a href="#" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title="" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="#" title="分享到 Line" data-sharer="line" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title=""><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="#" title="分享到 微博" data-sharer="weibo" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title=""><i class="fab fa-weibo fa-fw"></i></a><a href="#" title="分享到 Myspace" data-sharer="myspace" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title="" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="#" title="分享到 Blogger" data-sharer="blogger" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title="" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="#" title="分享到 Evernote" data-sharer="evernote" data-url="http://yanghx.vip/k8s%E5%85%A5%E9%97%A8/" data-title=""><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3k8s%E7%BD%91%E7%BB%9C/" class="prev" rel="prev" title=""><i class="fas fa-angle-left fa-fw"></i></a>
            <a href="/tomcat%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/" class="next" rel="next" title=""><i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.111.3">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.3.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">yanghx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="回到顶部">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div id="cookieconsent-container"></div><div class="assets"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>